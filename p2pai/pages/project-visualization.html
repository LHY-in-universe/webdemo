<!DOCTYPE html>
<html lang="en" data-i18n-title="edgeai.visualization.title">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P2PAIé¡¹ç›®å¯è§†åŒ– v2.3</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="../../shared/css/unified-styles.css?v=1756673004">
    
    <style>
        /* å¯è§†åŒ–å®¹å™¨ */
        .visualization-container {
            background: var(--bg-elevated);
            border: 1px solid var(--border-primary);
            border-radius: 16px;
            min-height: 600px;
            position: relative;
            overflow: hidden;
        }
        
        /* SVGæ ·å¼ */
        .node-svg {
            width: 100%;
            height: 600px;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            pointer-events: auto;
            overflow: hidden;
        }
        
        /* èŠ‚ç‚¹æ ·å¼ */
        .control-node {
            stroke-width: 3;
            cursor: pointer;
            transition: fill 0.3s ease, stroke 0.3s ease, stroke-width 0.3s ease;
            transform-origin: center;
            transform: none !important;
            position: static !important;
        }
        
        .control-node:hover {
            stroke-width: 4;
            filter: brightness(0.9);
        }
        
        /* P2PAIèŠ‚ç‚¹æ ·å¼ï¼šåŸºäºèŠ‚ç‚¹æ‰€æœ‰æƒå’ŒçŠ¶æ€ */
        .edge-node {
            stroke-width: 2;
            cursor: pointer;
            transition: fill 0.3s ease, stroke 0.3s ease, stroke-width 0.3s ease;
            transform-origin: center;
            transform: none !important;
            position: static !important;
        }
        
        /* è‡ªå·±çš„èŠ‚ç‚¹ - çº¢è‰²ï¼Œå¯ä»¥çœ‹åˆ°è¯¦ç»†çŠ¶æ€ */
        .edge-node.own-node {
            fill: #ef4444;
            stroke: #dc2626;
            stroke-width: 3;
        }
        
        .edge-node.own-node:hover {
            fill: #dc2626;
            stroke: #b91c1c;
            stroke-width: 4;
        }
        
        /* å…¶ä»–èŠ‚ç‚¹åœ¨çº¿ - ç»¿è‰² */
        .edge-node.other-online {
            fill: #10b981;
            stroke: #059669;
        }
        
        .edge-node.other-online:hover {
            fill: #059669;
            stroke: #047857;
            stroke-width: 3;
        }
        
        /* å…¶ä»–èŠ‚ç‚¹ç¦»çº¿ - ç°è‰² */
        .edge-node.other-offline {
            fill: #6b7280;
            stroke: #4b5563;
            opacity: 0.6;
        }
        
        .edge-node.other-offline:hover {
            fill: #4b5563;
            stroke: #374151;
            stroke-width: 3;
        }
        
        .edge-node:hover {
            stroke-width: 3;
        }
        
        /* è¿æ¥çº¿æ ·å¼ - é€æ˜è¿æ¥çº¿ + æµåŠ¨æ•°æ®æ®µ */
        .connection-line {
            stroke: rgba(107, 114, 128, 0.3);
            stroke-width: 2;
            fill: none;
            stroke-opacity: 0; /* é»˜è®¤é€æ˜ */
            transition: all 0.3s ease;
        }
        
        /* æ•°æ®ä¼ è¾“çº¿æ®µ */
        .data-segment {
            stroke: #10b981;
            stroke-width: 3;
            fill: none;
            stroke-linecap: round;
        }
        
        /* å‘ä¸‹æµåŠ¨åŠ¨ç”» (ä»æ§åˆ¶èŠ‚ç‚¹åˆ°è¾¹ç¼˜èŠ‚ç‚¹) */
        @keyframes data-segment-down {
            0% {
                stroke-dasharray: 25, 1000;
                stroke-dashoffset: 1025;
                stroke-opacity: 0.9;
            }
            50% {
                stroke-opacity: 1;
            }
            100% {
                stroke-dasharray: 25, 1000;
                stroke-dashoffset: 0;
                stroke-opacity: 0.9;
            }
        }
        
        /* å‘ä¸ŠæµåŠ¨åŠ¨ç”» (ä»è¾¹ç¼˜èŠ‚ç‚¹åˆ°æ§åˆ¶èŠ‚ç‚¹) */
        @keyframes data-segment-up {
            0% {
                stroke-dasharray: 25, 1000;
                stroke-dashoffset: 0;
                stroke-opacity: 0.9;
            }
            50% {
                stroke-opacity: 1;
            }
            100% {
                stroke-dasharray: 25, 1000;
                stroke-dashoffset: 1025;
                stroke-opacity: 0.9;
            }
        }
        
        .data-segment.flow-down {
            animation: data-segment-down 4s ease-in-out;
        }
        
        .data-segment.flow-up {
            animation: data-segment-up 4s ease-in-out;
        }
        
        /* èŠ‚ç‚¹æ ‡ç­¾ */
        .node-label {
            font-size: 12px;
            font-weight: 600;
            text-anchor: middle;
            dominant-baseline: middle;
            fill: currentColor;
        }
        
        /* è¿›åº¦æŒ‡ç¤ºå™¨ */
        .progress-ring {
            fill: none;
            stroke-width: 4;
            stroke: #e5e7eb;
        }
        
        .progress-ring.active {
            stroke: #3b82f6;
            stroke-dasharray: 94.2; /* 2Ï€ * 15 */
            stroke-dashoffset: 94.2;
            animation: progress-animation 2s ease-in-out;
        }
        
        @keyframes progress-animation {
            to {
                stroke-dashoffset: 0;
            }
        }
        
        /* èŠ‚ç‚¹åŠ¨ç”»æ•ˆæœ */
        .node-fade-in {
            opacity: 0;
            transform: scale(0.8);
            animation: fadeInScale 0.6s ease-out forwards;
        }
        
        .node-fade-out {
            opacity: 1;
            transform: scale(1);
            animation: fadeOutScale 0.4s ease-in forwards;
        }
        
        @keyframes fadeInScale {
            0% {
                opacity: 0;
                transform: scale(0.8);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        @keyframes fadeOutScale {
            0% {
                opacity: 1;
                transform: scale(1);
            }
            100% {
                opacity: 0;
                transform: scale(0.8);
            }
        }
        
        /* è®­ç»ƒå®ŒæˆçŠ¶æ€æ ·å¼ */
        .training-complete-title {
            font-size: 32px;
            font-weight: bold;
            fill: #10b981;
            opacity: 0;
            animation: celebrationFadeIn 1s ease-out 0.5s forwards;
        }
        
        .training-complete-subtitle {
            font-size: 18px;
            font-weight: 600;
            fill: #059669;
            opacity: 0;
            animation: celebrationFadeIn 1s ease-out 1s forwards;
        }
        
        .training-complete-stats {
            font-size: 14px;
            fill: #6b7280;
            opacity: 0;
            animation: celebrationFadeIn 1s ease-out 1.5s forwards;
        }
        
        @keyframes celebrationFadeIn {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* æ·±è‰²æ¨¡å¼é€‚é… */
        [data-theme="dark"] .visualization-container {
            background: rgba(31, 41, 55, 0.8);
            border-color: rgba(75, 85, 99, 0.4);
        }
        
        [data-theme="dark"] .node-label {
            fill: #f9fafb;
        }
        
        [data-theme="dark"] .connection-line {
            stroke: rgba(156, 163, 175, 0.4);
            stroke-opacity: 0; /* æš—è‰²æ¨¡å¼ä¸‹ä¹Ÿä¿æŒé€æ˜ */
        }
        
        /* æ§åˆ¶é¢æ¿ */
        .control-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--bg-elevated);
            border: 1px solid var(--border-primary);
            border-radius: 12px;
            padding: 24px;
            width: 440px;
            box-shadow: var(--shadow-lg);
            z-index: 10;
        }
        
        [data-theme="dark"] .control-panel {
            background: rgba(31, 41, 55, 0.9);
            border-color: rgba(75, 85, 99, 0.4);
        }
        
        /* èŠ‚ç‚¹è¯¦æƒ…é¢æ¿ */
        .node-details {
            position: absolute;
            top: 20px;
            right: 480px;
            width: 360px;
            max-height: 560px;
            overflow-y: auto;
            background: var(--bg-elevated);
            border: 1px solid var(--border-primary);
            border-radius: 12px;
            padding: 24px;
            box-shadow: var(--shadow-lg);
            transform: translateX(calc(100% + 500px));
            transition: transform 0.3s ease;
            z-index: 1000;
        }
        
        .node-details.show {
            transform: translateX(0);
        }
        
        [data-theme="dark"] .node-details {
            background: rgba(31, 41, 55, 0.95);
            border-color: rgba(75, 85, 99, 0.4);
            color: rgba(243, 244, 246, 0.9);
        }
        
        /* æ·±è‰²æ¨¡å¼ä¸‹èŠ‚ç‚¹è¯¦æƒ…é¢æ¿å†…å®¹æ ·å¼ */
        [data-theme="dark"] .node-details .space-y-3 > div {
            background-color: rgba(55, 65, 81, 0.3);
            border-radius: 6px;
            padding: 8px 12px;
            margin: 4px 0;
        }
        
        [data-theme="dark"] .node-details h4 {
            color: rgba(243, 244, 246, 0.9);
        }
        
        [data-theme="dark"] .node-details .text-sm {
            color: rgba(156, 163, 175, 0.9);
        }
        
        [data-theme="dark"] .node-details .font-semibold {
            color: rgba(243, 244, 246, 0.95);
        }
        
        /* æ¦‚è§ˆå¡ç‰‡ */
        .overview-card {
            background: var(--bg-elevated);
            border: 1px solid var(--border-primary);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
        }
        
        [data-theme="dark"] .overview-card {
            background: rgba(31, 41, 55, 0.9);
            border-color: rgba(75, 85, 99, 0.4);
        }
        
        /* æ·±è‰²æ¨¡å¼ä¸‹çš„è¡¨æ ¼å’Œå¡ç‰‡æ ·å¼ */
        [data-theme="dark"] table {
            background: rgba(31, 41, 55, 0.9);
        }
        
        [data-theme="dark"] .bg-white {
            background-color: rgba(31, 41, 55, 0.8) !important;
        }
        
        [data-theme="dark"] .bg-gray-50 {
            background-color: rgba(55, 65, 81, 0.8) !important;
        }
        
        [data-theme="dark"] .hover\:bg-gray-50:hover {
            background-color: rgba(75, 85, 99, 0.6) !important;
        }
        
        [data-theme="dark"] .text-gray-900 {
            color: rgba(243, 244, 246, 0.9) !important;
        }
        
        [data-theme="dark"] .text-gray-600 {
            color: rgba(156, 163, 175, 0.9) !important;
        }
        
        [data-theme="dark"] .text-gray-500 {
            color: rgba(107, 114, 128, 0.9) !important;
        }
        
        [data-theme="dark"] .border-gray-200 {
            border-color: rgba(75, 85, 99, 0.4) !important;
        }
        
        [data-theme="dark"] .divide-gray-200 > :not([hidden]) ~ :not([hidden]) {
            border-color: rgba(75, 85, 99, 0.4) !important;
        }
        
        /* æ·±è‰²æ¨¡å¼ä¸‹è¡¨æ ¼è¡ŒèƒŒæ™¯ */
        [data-theme="dark"] tbody tr {
            background-color: rgba(31, 41, 55, 0.8) !important;
        }
        
        [data-theme="dark"] tbody tr:hover {
            background-color: rgba(75, 85, 99, 0.6) !important;
        }
        
        /* æ·±è‰²æ¨¡å¼ä¸‹æŒ‰é’®æ ·å¼ */
        [data-theme="dark"] .cursor-pointer:hover {
            background-color: rgba(75, 85, 99, 0.6) !important;
        }
        
        /* æ·±è‰²æ¨¡å¼ä¸‹è¿›åº¦æ¡ */
        [data-theme="dark"] .bg-gray-200 {
            background-color: rgba(55, 65, 81, 0.8) !important;
        }
        
        /* æ·±è‰²æ¨¡å¼ä¸‹çŠ¶æ€æ ‡ç­¾èƒŒæ™¯ */
        [data-theme="dark"] .bg-blue-100 {
            background-color: rgba(59, 130, 246, 0.2) !important;
        }
        
        [data-theme="dark"] .bg-green-100 {
            background-color: rgba(16, 185, 129, 0.2) !important;
        }
        
        [data-theme="dark"] .bg-red-100 {
            background-color: rgba(239, 68, 68, 0.2) !important;
        }
        
        [data-theme="dark"] .bg-gray-100 {
            background-color: rgba(55, 65, 81, 0.6) !important;
        }
        
        /* æ·±è‰²æ¨¡å¼ä¸‹é“¾æ¥å’ŒæŒ‰é’®é¢œè‰² */
        [data-theme="dark"] .text-indigo-600 {
            color: rgba(129, 140, 248, 0.9) !important;
        }
        
        [data-theme="dark"] .hover\:text-indigo-900:hover {
            color: rgba(165, 180, 252, 0.9) !important;
        }
        
        /* æ·±è‰²æ¨¡å¼ä¸‹è¡¨æ ¼ä¸­çš„æŸ¥çœ‹è¯¦æƒ…æŒ‰é’® */
        [data-theme="dark"] td button.text-indigo-600 {
            background-color: transparent !important;
            border-color: rgba(129, 140, 248, 0.5) !important;
            color: rgba(129, 140, 248, 0.9) !important;
            pointer-events: auto !important;
            cursor: pointer !important;
        }
        
        [data-theme="dark"] td button.text-indigo-600:hover {
            background-color: rgba(55, 65, 81, 0.3) !important;
            border-color: rgba(165, 180, 252, 0.8) !important;
            color: rgba(165, 180, 252, 1) !important;
        }
        
        [data-theme="dark"] thead {
            background: rgba(55, 65, 81, 0.8);
        }
        
        /* è¯¦ç»†ä¿¡æ¯æ¨¡æ€å¡ç‰‡ */
        .node-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .node-modal.show {
            opacity: 1;
            visibility: visible;
        }
        
        .node-modal-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            width: 90%;
            max-width: 900px;
            max-height: 85vh;
            overflow-y: auto;
            transform: translateY(20px) scale(0.95);
            transition: all 0.3s ease;
        }
        
        .node-modal.show .node-modal-card {
            transform: translateY(0) scale(1);
        }
        
        /* æ·±è‰²æ¨¡å¼ä¸‹çš„æ¨¡æ€å¡ç‰‡ */
        [data-theme="dark"] .node-modal-card {
            background: rgba(31, 41, 55, 0.95);
            border: 1px solid rgba(75, 85, 99, 0.3);
            color: rgba(243, 244, 246, 0.9);
        }

        [data-theme="dark"] .node-modal-card .bg-gray-50 {
            background: rgba(55, 65, 81, 0.6) !important;
        }

        [data-theme="dark"] .node-modal-card .text-gray-900 {
            color: rgba(243, 244, 246, 0.9) !important;
        }

        [data-theme="dark"] .node-modal-card .text-gray-600 {
            color: rgba(156, 163, 175, 0.9) !important;
        }

        [data-theme="dark"] .node-modal-card .text-gray-700 {
            color: rgba(209, 213, 219, 0.9) !important;
        }

        [data-theme="dark"] .node-modal-card .bg-blue-100 {
            background: rgba(55, 65, 81, 0.8) !important;
            color: rgba(129, 140, 248, 0.9) !important;
        }

        [data-theme="dark"] .node-modal-card .bg-white {
            background: rgba(75, 85, 99, 0.4) !important;
        }

        [data-theme="dark"] .node-modal-card .border-gray-200 {
            border-color: rgba(75, 85, 99, 0.5) !important;
        }

        [data-theme="dark"] .node-modal-card .text-gray-400 {
            color: rgba(156, 163, 175, 0.8) !important;
        }

        [data-theme="dark"] .node-modal-card .text-gray-500 {
            color: rgba(107, 114, 128, 0.9) !important;
        }
        
        /* æ·±è‰²æ¨¡å¼ä¸‹çš„è­¦å‘Šæ¡†æ ·å¼ */
        [data-theme="dark"] .node-modal-card .bg-yellow-50 {
            background: rgba(92, 66, 0, 0.3) !important;
        }
        
        [data-theme="dark"] .node-modal-card .border-yellow-200 {
            border-color: rgba(180, 83, 9, 0.4) !important;
        }
        
        [data-theme="dark"] .node-modal-card .text-yellow-600 {
            color: rgba(251, 191, 36, 0.9) !important;
        }
        
        [data-theme="dark"] .node-modal-card .text-yellow-700 {
            color: rgba(245, 158, 11, 0.9) !important;
        }
        
        /* æ·±è‰²æ¨¡å¼ä¸‹çš„ä¿¡æ¯æ¡†æ ·å¼ */
        [data-theme="dark"] .node-modal-card .bg-blue-50 {
            background: rgba(30, 58, 138, 0.2) !important;
        }
        
        [data-theme="dark"] .node-modal-card .border-blue-200 {
            border-color: rgba(59, 130, 246, 0.3) !important;
        }
        
        [data-theme="dark"] .node-modal-card .text-blue-800 {
            color: rgba(147, 197, 253, 0.9) !important;
        }
        
        [data-theme="dark"] .node-modal-card .text-blue-700 {
            color: rgba(96, 165, 250, 0.9) !important;
        }

        /* æ·±è‰²æ¨¡å¼ä¸‹æ‰€æœ‰buttonå…ƒç´ çš„é»˜è®¤æ ·å¼ */
        [data-theme="dark"] button:not(.text-indigo-600) {
            background-color: rgba(55, 65, 81, 0.7) !important;
            border-color: rgba(75, 85, 99, 0.5) !important;
            color: rgba(243, 244, 246, 0.9) !important;
        }
        
        [data-theme="dark"] button:not(.text-indigo-600):hover {
            background-color: rgba(75, 85, 99, 0.8) !important;
        }
        
        /* æ·±è‰²æ¨¡å¼ä¸‹çš„ç»Ÿè®¡å¡ç‰‡æ–‡å­— */
        [data-theme="dark"] .text-center .text-sm {
            color: rgba(156, 163, 175, 0.9) !important;
        }
        
        [data-theme="dark"] tbody tr {
            background: rgba(31, 41, 55, 0.8);
            border-color: rgba(75, 85, 99, 0.3);
        }
        
        [data-theme="dark"] tbody tr:hover {
            background: rgba(55, 65, 81, 0.6);
        }
        
        [data-theme="dark"] th,
        [data-theme="dark"] td {
            color: rgba(243, 244, 246, 0.9);
        }
        
        /* é¡¹ç›®ä¿¡æ¯å¤´éƒ¨æš—è‰²ä¸»é¢˜ */
        [data-theme="dark"] .project-info-header .bg-white {
            background: rgba(31, 41, 55, 0.9) !important;
            border-color: rgba(75, 85, 99, 0.4) !important;
        }
        
        [data-theme="dark"] .project-info-header h2 {
            color: rgba(243, 244, 246, 0.95) !important;
        }
        
        [data-theme="dark"] .project-info-header p {
            color: rgba(156, 163, 175, 0.9) !important;
        }
    </style>
</head>
<body class="module-background theme-transition">
    <!-- Navigation -->
    <nav class="navbar fade-in-up">
        <div class="max-w-7xl mx-auto flex items-center justify-between">
            <div class="navbar-brand">
                <button onclick="goBack()" class="btn btn-secondary mr-3 btn-click">
                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                    </svg>
                    <span data-i18n="common.back">è¿”å›</span>
                </button>
                <span>P2PAIé¡¹ç›®å¯è§†åŒ–</span>
                <span id="projectName" class="ml-2 text-sm text-gray-600"></span>
            </div>
            
            <div class="navbar-nav">
                <button class="theme-toggle" title="Toggle Theme">
                    <span>ğŸŒ™</span>
                </button>
                <button class="language-toggle" title="Switch Language">EN</button>
            </div>
        </div>
    </nav>

    <div class="max-w-7xl mx-auto px-6 py-8 content-area">
        <!-- é¡¹ç›®ä¿¡æ¯åŒºåŸŸ -->
        <div class="project-info-header mb-8 fade-in-up">
            <div class="bg-white rounded-xl border border-gray-200 p-6 shadow-sm">
                <div class="flex items-start justify-between mb-6">
                    <div class="flex-1">
                        <h2 id="projectTitle" class="text-2xl font-bold text-gray-900 mb-2" data-i18n="p2pai.dashboard.project.distributedTraining">Single Model Node Project</h2>
                        <p id="projectDescription" class="text-gray-600 mb-4" data-i18n="p2pai.dashboard.project.description">åŸºäºP2PAIçš„å¤šæ–¹è®¡ç®—è®­ç»ƒç³»ç»Ÿï¼Œå®ç°éšç§ä¿æŠ¤çš„åˆ†å¸ƒå¼æœºå™¨å­¦ä¹ å’Œæ¨¡å‹ååŒè®­ç»ƒã€‚</p>
                        
                        <div class="flex flex-wrap items-center gap-x-8 gap-y-2 text-sm">
                            <div class="flex items-center whitespace-nowrap">
                                <div id="statusDot" class="w-2 h-2 bg-green-500 rounded-full mr-2 flex-shrink-0"></div>
                                <span class="text-gray-500" data-i18n="p2pai.dashboard.project.statusLabel">çŠ¶æ€ï¼š</span>
                                <span id="projectStatus" class="font-semibold text-green-600 ml-2" data-i18n="p2pai.dashboard.project.statuses.training">è®­ç»ƒä¸­</span>
                            </div>
                            <div class="flex items-center whitespace-nowrap">
                                <svg class="w-4 h-4 text-gray-400 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                <span class="text-gray-500" data-i18n="p2pai.dashboard.project.createdTime">åˆ›å»ºæ—¶é—´ï¼š</span>
                                <span id="projectCreated" class="font-medium ml-2">2024-01-15</span>
                            </div>
                            <div class="flex items-center whitespace-nowrap">
                                <svg class="w-4 h-4 text-gray-400 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                                </svg>
                                <span class="text-gray-500" data-i18n="p2pai.dashboard.project.lastUpdated">æœ€åæ›´æ–°ï¼š</span>
                                <span id="projectUpdated" class="font-medium ml-2">2å°æ—¶å‰</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex items-center space-x-4 ml-6">
                        <!-- æ•´ä½“è¿›åº¦åœ†ç¯ -->
                        <div class="relative w-20 h-20">
                            <svg class="w-20 h-20 transform -rotate-90" viewBox="0 0 100 100">
                                <circle cx="50" cy="50" r="40" stroke="currentColor" stroke-width="8" fill="transparent" class="text-gray-200"></circle>
                                <circle id="progressCircle" cx="50" cy="50" r="40" stroke="currentColor" stroke-width="8" fill="transparent" stroke-dasharray="251.2" stroke-dashoffset="62.8" class="text-green-500 transition-all duration-500"></circle>
                            </svg>
                            <div class="absolute inset-0 flex items-center justify-center">
                                <span id="overallProgress" class="text-lg font-bold text-gray-900">75%</span>
                            </div>
                        </div>
                        
                        <!-- å¿«é€Ÿç»Ÿè®¡ -->
                        <div class="text-right space-y-1">
                            <div class="text-2xl font-bold text-gray-900" id="quickNodeCount">15</div>
                            <div class="text-sm text-gray-500" data-i18n="p2pai.dashboard.project.totalParticipants">å‚ä¸æ–¹æ€»æ•°</div>
                            <div class="text-sm">
                                <span class="text-green-600 font-semibold" id="quickOnlineCount">12</span> <span data-i18n="p2pai.dashboard.project.online">åœ¨çº¿</span>
                                <span class="text-gray-400">/</span> 
                                <span class="text-red-600 font-semibold">1</span> <span data-i18n="p2pai.dashboard.project.myNode">æˆ‘çš„èŠ‚ç‚¹</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- é¡¹ç›®é…ç½®ä¿¡æ¯ -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 pt-4 border-t border-gray-100">
                    <div class="text-center">
                        <div class="text-sm text-gray-500 mb-1" data-i18n="p2pai.dashboard.project.aiModel">AIæ¨¡å‹</div>
                        <div class="font-semibold text-gray-900" id="aiModelType" data-i18n="p2pai.dashboard.project.cnnDeepLearning">CNNæ·±åº¦å­¦ä¹ </div>
                    </div>
                    <div class="text-center">
                        <div class="text-sm text-gray-500 mb-1" data-i18n="p2pai.dashboard.project.trainingStrategy">è®­ç»ƒç­–ç•¥</div>
                        <div class="font-semibold text-gray-900" id="trainingStrategy" data-i18n="p2pai.dashboard.project.federatedLearning">è”é‚¦å­¦ä¹ </div>
                    </div>
                    <div class="text-center">
                        <div class="text-sm text-gray-500 mb-1" data-i18n="p2pai.dashboard.project.targetAccuracy">ç›®æ ‡å‡†ç¡®ç‡</div>
                        <div class="font-semibold text-gray-900" id="targetAccuracy">â‰¥90%</div>
                    </div>
                    <div class="text-center">
                        <div class="text-sm text-gray-500 mb-1" data-i18n="p2pai.dashboard.project.estimatedCompletion">é¢„è®¡å®Œæˆ</div>
                        <div class="font-semibold text-gray-900" id="estimatedTime">2å¤©å</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- å¯è§†åŒ–ä¸»å®¹å™¨ -->
        <div class="visualization-container mb-8 fade-in-up delay-1">
            <svg id="networkSvg" class="node-svg">
                <!-- èƒŒæ™¯ç½‘æ ¼ -->
                <defs>
                    <pattern id="grid" width="50" height="50" patternUnits="userSpaceOnUse">
                        <path d="M 50 0 L 0 0 0 50" fill="none" stroke="currentColor" stroke-width="0.5" opacity="0.1"/>
                    </pattern>
                </defs>
                <rect width="100%" height="100%" fill="url(#grid)" />
                
                <!-- è¿æ¥çº¿å±‚ -->
                <g id="connections"></g>
                
                <!-- èŠ‚ç‚¹å±‚ -->
                <g id="nodes"></g>
                
                <!-- æ ‡ç­¾å±‚ -->
                <g id="labels"></g>
                
                <!-- è®­ç»ƒå®ŒæˆçŠ¶æ€è¦†ç›–å±‚ -->
                <g id="trainingComplete" style="display: none;">
                    <!-- èƒŒæ™¯é®ç½© -->
                    <rect width="100%" height="100%" fill="rgba(16, 185, 129, 0.1)" rx="10"/>
                    
                    <!-- å®ŒæˆçŠ¶æ€æ–‡å­— -->
                    <text x="50%" y="40%" text-anchor="middle" class="training-complete-title">
                        ğŸ‰ è®­ç»ƒå®Œæˆ ğŸ‰
                    </text>
                    
                    <text x="50%" y="50%" text-anchor="middle" class="training-complete-subtitle">
                        æ‰€æœ‰è¾¹ç¼˜èŠ‚ç‚¹å·²å®Œæˆè®­ç»ƒä»»åŠ¡
                    </text>
                    
                    <text x="50%" y="60%" text-anchor="middle" class="training-complete-stats" id="trainingCompleteStats">
                        å…±å®Œæˆ 0 ä¸ªèŠ‚ç‚¹çš„è®­ç»ƒ
                    </text>
                </g>
            </svg>
            
            <!-- æ§åˆ¶é¢æ¿ -->
            <div class="control-panel">
                <h4 class="text-lg font-semibold mb-4" data-i18n="p2pai.dashboard.project.controlPanel">æ§åˆ¶é¢æ¿</h4>
                
                <!-- æŒ‰é’®ç½‘æ ¼å¸ƒå±€ -->
                <div class="grid grid-cols-2 gap-3 mb-6">
                    <button onclick="showInviteUserModal()" class="btn btn-primary btn-click text-sm py-3 px-4">
                        <span data-i18n="p2pai.dashboard.project.inviteParticipants">é‚€è¯·å‚ä¸æ–¹</span>
                    </button>
                    <button onclick="showAddNodeModal()" class="btn btn-secondary btn-click text-sm py-3 px-4">
                        <span data-i18n="p2pai.dashboard.project.addComputeNode">æ·»åŠ è®¡ç®—èŠ‚ç‚¹</span>
                    </button>
                    <button onclick="startTraining()" class="btn btn-secondary btn-click text-sm py-3 px-4">
                        <span data-i18n="p2pai.dashboard.project.startTraining">å¼€å§‹è®­ç»ƒ</span>
                    </button>
                    <button onclick="resetView()" class="btn btn-secondary btn-click text-sm py-3 px-4">
                        <span data-i18n="p2pai.dashboard.project.resetView">é‡ç½®è§†å›¾</span>
                    </button>
                </div>
                
                <!-- æµ‹è¯•æŒ‰é’®å•ç‹¬ä¸€è¡Œ -->
                <div class="mb-6">
                    <button onclick="completeAllTraining()" class="btn btn-success btn-click w-full text-sm py-3">
                        <span data-i18n="p2pai.dashboard.project.completeTraining">å®Œæˆè®­ç»ƒ(æµ‹è¯•)</span>
                    </button>
                </div>
                
                <!-- å®æ—¶çŠ¶æ€ -->
                <div class="pt-4 border-t border-gray-200">
                    <h5 class="text-base font-medium text-gray-600 mb-3" data-i18n="p2pai.dashboard.project.realTimeStatus">å®æ—¶çŠ¶æ€</h5>
                    <div class="grid grid-cols-3 gap-4">
                        <div class="text-center">
                            <div class="text-2xl font-bold text-green-600" id="onlineNodes">8</div>
                            <div class="text-sm text-gray-600" data-i18n="p2pai.dashboard.project.onlineParticipants">åœ¨çº¿å‚ä¸æ–¹</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-red-600" id="trainingNodes">97%</div>
                            <div class="text-sm text-gray-600" data-i18n="p2pai.dashboard.project.myProgress">æˆ‘çš„è¿›åº¦</div>
                        </div>
                        <div class="text-center">
                            <div class="text-lg font-bold text-purple-600" id="dataTransfer">åŠ å¯†</div>
                            <div class="text-sm text-gray-600" data-i18n="p2pai.dashboard.project.transmissionSecurity">ä¼ è¾“å®‰å…¨</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- èŠ‚ç‚¹è¯¦æƒ…é¢æ¿ -->
            <div id="nodeDetails" class="node-details">
                <div class="flex justify-between items-center mb-4">
                    <h4 class="text-lg font-semibold" id="nodeTitle" data-i18n="p2pai.dashboard.project.nodeDetails">èŠ‚ç‚¹è¯¦æƒ…</h4>
                    <button onclick="closeNodeDetails()" class="btn btn-secondary btn-click text-sm py-2 px-4">
                        <span data-i18n="common.close">å…³é—­</span>
                    </button>
                </div>
                <div id="nodeInfo" class="space-y-3">
                    <!-- èŠ‚ç‚¹ä¿¡æ¯å°†åœ¨è¿™é‡ŒåŠ¨æ€å¡«å…… -->
                </div>
            </div>
        </div>

        <!-- é‚€è¯·ç”¨æˆ·æ¨¡æ€å¡ç‰‡ -->
        <div id="inviteUserModal" class="node-modal">
            <div class="node-modal-card" style="max-width: 600px;">
                <div class="p-6">
                    <!-- å¡ç‰‡å¤´éƒ¨ -->
                    <div class="flex justify-between items-center mb-6">
                        <div class="flex items-center space-x-4">
                            <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
                                <svg class="w-6 h-6 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
                                </svg>
                            </div>
                            <div>
                                <h2 class="text-2xl font-bold text-gray-900" data-i18n="p2pai.dashboard.project.inviteUser">é‚€è¯·ç”¨æˆ·</h2>
                                <p class="text-gray-600">é‚€è¯·å…¶ä»–ç”¨æˆ·å‚ä¸EdgeAIé¡¹ç›®</p>
                            </div>
                        </div>
                        <button onclick="closeInviteUserModal()" class="text-gray-400 hover:text-gray-600 transition-colors">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>

                    <!-- é‚€è¯·è¡¨å• -->
                    <div class="space-y-6">
                        <!-- é‚®ç®±è¾“å…¥ -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ç”¨æˆ·é‚®ç®±</label>
                            <div class="flex space-x-3">
                                <input type="email" id="inviteEmail" placeholder="è¯·è¾“å…¥ç”¨æˆ·é‚®ç®±åœ°å€" 
                                       onkeypress="if(event.key==='Enter') addEmailToList()"
                                       class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <button onclick="addEmailToList()" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
                                    æ·»åŠ 
                                </button>
                            </div>
                        </div>

                        <!-- é‚®ç®±åˆ—è¡¨ -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">å¾…é‚€è¯·ç”¨æˆ·åˆ—è¡¨</label>
                            <div id="inviteEmailList" class="min-h-[100px] border border-gray-200 rounded-lg p-3 space-y-2">
                                <!-- åŠ¨æ€æ·»åŠ çš„é‚®ç®±åˆ—è¡¨ -->
                                <div class="text-gray-500 text-sm">æš‚æ— å¾…é‚€è¯·ç”¨æˆ·</div>
                            </div>
                        </div>

                        <!-- æƒé™é€‰æ‹© -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ç”¨æˆ·æƒé™</label>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="flex items-center p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50">
                                    <input type="radio" name="userRole" value="participant" checked class="mr-3">
                                    <div>
                                        <div class="font-medium">å‚ä¸è€…</div>
                                        <div class="text-sm text-gray-500">å¯å‚ä¸è®­ç»ƒ</div>
                                    </div>
                                </label>
                                <label class="flex items-center p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50">
                                    <input type="radio" name="userRole" value="observer" class="mr-3">
                                    <div>
                                        <div class="font-medium">è§‚å¯Ÿè€…</div>
                                        <div class="text-sm text-gray-500">ä»…æŸ¥çœ‹æƒé™</div>
                                    </div>
                                </label>
                            </div>
                        </div>

                        <!-- é‚€è¯·æ¶ˆæ¯ -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">é‚€è¯·æ¶ˆæ¯ (å¯é€‰)</label>
                            <textarea id="inviteMessage" rows="3" placeholder="è¯·è¾“å…¥é‚€è¯·æ¶ˆæ¯..." 
                                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">æ‚¨å¥½ï¼Œæˆ‘é‚€è¯·æ‚¨å‚ä¸æˆ‘ä»¬çš„EdgeAIé¡¹ç›®ã€‚æœŸå¾…ä¸æ‚¨åˆä½œï¼</textarea>
                        </div>
                    </div>

                    <!-- åº•éƒ¨æ“ä½œæŒ‰é’® -->
                    <div class="flex justify-end space-x-3 mt-8 pt-6 border-t border-gray-200">
                        <button onclick="closeInviteUserModal()" class="px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition-colors">
                            <span data-i18n="common.cancel">å–æ¶ˆ</span>
                        </button>
                        <button onclick="sendInvitations()" class="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors">
                            å‘é€é‚€è¯·
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ·»åŠ èŠ‚ç‚¹æ¨¡æ€å¡ç‰‡ -->
        <div id="addNodeModal" class="node-modal">
            <div class="node-modal-card" style="max-width: 700px;">
                <div class="p-6">
                    <!-- å¡ç‰‡å¤´éƒ¨ -->
                    <div class="flex justify-between items-center mb-6">
                        <div class="flex items-center space-x-4">
                            <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center">
                                <svg class="w-6 h-6 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                </svg>
                            </div>
                            <div>
                                <h2 class="text-2xl font-bold text-gray-900" data-i18n="p2pai.dashboard.project.addNode">æ·»åŠ èŠ‚ç‚¹</h2>
                                <p class="text-gray-600">æ·»åŠ æ–°çš„è¾¹ç¼˜èŠ‚ç‚¹åˆ°è®­ç»ƒç½‘ç»œ</p>
                            </div>
                        </div>
                        <button onclick="closeAddNodeModal()" class="text-gray-400 hover:text-gray-600 transition-colors">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>

                    <!-- æ·»åŠ èŠ‚ç‚¹è¡¨å• -->
                    <div class="space-y-6">
                        <!-- èŠ‚ç‚¹åŸºç¡€ä¿¡æ¯ -->
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">èŠ‚ç‚¹åç§°</label>
                                <input type="text" id="nodeName" placeholder="ä¾‹å¦‚ï¼šèŠ‚ç‚¹21" 
                                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">èŠ‚ç‚¹åœ°å€</label>
                                <input type="text" id="nodeAddress" placeholder="http://192.168.1.121:8080" 
                                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                            </div>
                        </div>

                        <!-- èŠ‚ç‚¹ç±»å‹é€‰æ‹© -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">èŠ‚ç‚¹ç±»å‹</label>
                            <div class="grid grid-cols-3 gap-3">
                                <label class="flex items-center p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50">
                                    <input type="radio" name="nodeType" value="edge" checked class="mr-3">
                                    <div>
                                        <div class="font-medium">è¾¹ç¼˜èŠ‚ç‚¹</div>
                                        <div class="text-sm text-gray-500">å‚ä¸è®­ç»ƒ</div>
                                    </div>
                                </label>
                                <label class="flex items-center p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50">
                                    <input type="radio" name="nodeType" value="control" class="mr-3">
                                    <div>
                                        <div class="font-medium">æ¨¡å‹èŠ‚ç‚¹</div>
                                        <div class="text-sm text-gray-500">åè°ƒè®­ç»ƒ</div>
                                    </div>
                                </label>
                                <label class="flex items-center p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50">
                                    <input type="radio" name="nodeType" value="observer" class="mr-3">
                                    <div>
                                        <div class="font-medium">è§‚å¯ŸèŠ‚ç‚¹</div>
                                        <div class="text-sm text-gray-500">ä»…ç›‘æ§</div>
                                    </div>
                                </label>
                            </div>
                        </div>

                        <!-- è¿æ¥é…ç½® -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">è¿æ¥åˆ°æ¨¡å‹èŠ‚ç‚¹</label>
                            <select id="connectToControl" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                <option value="">é€‰æ‹©æ¨¡å‹èŠ‚ç‚¹...</option>
                                <option value="http://192.168.1.100:8080">ä¸»æ§èŠ‚ç‚¹1 (192.168.1.100:8080)</option>
                                <option value="http://192.168.1.101:8080">ä¸»æ§èŠ‚ç‚¹2 (192.168.1.101:8080)</option>
                                <option value="http://192.168.1.102:8080">å¤‡ç”¨æ§åˆ¶ (192.168.1.102:8080)</option>
                            </select>
                        </div>

                        <!-- èµ„æºé…ç½® */
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">é¢„æœŸèµ„æºé…ç½®</label>
                            <div class="grid grid-cols-3 gap-4">
                                <div>
                                    <label class="block text-xs text-gray-500 mb-1">CPUæ ¸å¿ƒæ•°</label>
                                    <input type="number" id="nodeCpuCores" placeholder="4" min="1" max="64" 
                                           class="w-full px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-500 mb-1">å†…å­˜ (GB)</label>
                                    <input type="number" id="nodeMemory" placeholder="8" min="1" max="128" 
                                           class="w-full px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-500 mb-1">GPUç±»å‹</label>
                                    <select id="nodeGpuType" class="w-full px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                        <option value="">æ— GPU</option>
                                        <option value="rtx3080">RTX 3080</option>
                                        <option value="rtx3090">RTX 3090</option>
                                        <option value="rtx4090">RTX 4090</option>
                                        <option value="tesla">Teslaç³»åˆ—</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- å®‰å…¨é…ç½® -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">å®‰å…¨é…ç½®</label>
                            <div class="space-y-3">
                                <label class="flex items-center">
                                    <input type="checkbox" id="enableSSL" checked class="mr-3">
                                    <span>å¯ç”¨SSLåŠ å¯†é€šä¿¡</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="enableAuth" checked class="mr-3">
                                    <span>å¯ç”¨èŠ‚ç‚¹èº«ä»½éªŒè¯</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="enableMonitoring" checked class="mr-3">
                                    <span>å¯ç”¨æ€§èƒ½ç›‘æ§</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- åº•éƒ¨æ“ä½œæŒ‰é’® -->
                    <div class="flex justify-end space-x-3 mt-8 pt-6 border-t border-gray-200">
                        <button onclick="closeAddNodeModal()" class="px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition-colors">
                            <span data-i18n="common.cancel">å–æ¶ˆ</span>
                        </button>
                        <button onclick="testNodeConnection()" class="px-4 py-2 bg-yellow-500 hover:bg-yellow-600 text-white rounded-lg transition-colors">
                            æµ‹è¯•è¿æ¥
                        </button>
                        <button onclick="addNewNode()" class="px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors">
                            æ·»åŠ èŠ‚ç‚¹
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- è¯¦ç»†ä¿¡æ¯æ¨¡æ€å¡ç‰‡ -->
        <div id="nodeModal" class="node-modal">
            <div class="node-modal-card">
                <div class="p-6">
                    <!-- å¡ç‰‡å¤´éƒ¨ -->
                    <div class="flex justify-between items-center mb-6">
                        <div class="flex items-center space-x-4">
                            <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
                                <div class="w-6 h-6 bg-blue-500 rounded-full"></div>
                            </div>
                            <div>
                                <h2 class="text-2xl font-bold text-gray-900" id="modalNodeTitle">èŠ‚ç‚¹è¯¦æƒ…</h2>
                                <p class="text-gray-600" id="modalNodeStatus">çŠ¶æ€ä¿¡æ¯</p>
                            </div>
                        </div>
                        <button onclick="closeNodeModal()" class="text-gray-400 hover:text-gray-600 transition-colors">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>

                    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <!-- å·¦ä¾§ï¼šåŸºç¡€ä¿¡æ¯å’Œè¿æ¥ä¿¡æ¯ -->
                        <div class="space-y-6">
                            <!-- åŸºç¡€ä¿¡æ¯å¡ç‰‡ -->
                            <div class="bg-gray-50 rounded-lg p-6">
                                <h3 class="text-lg font-semibold mb-4 text-gray-900" data-i18n="p2pai.dashboard.project.basicInfo">åŸºç¡€ä¿¡æ¯</h3>
                                <div class="space-y-3">
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">èŠ‚ç‚¹åç§°ï¼š</span>
                                        <span class="font-semibold" id="modalNodeName">-</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">èŠ‚ç‚¹åœ°å€ï¼š</span>
                                        <span class="font-mono text-sm bg-blue-100 px-2 py-1 rounded" id="modalNodeUrl">-</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">è®­ç»ƒè½®æ¬¡ï¼š</span>
                                        <span class="font-semibold" id="modalTrainingRounds">-</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">è®­ç»ƒè¿›åº¦ï¼š</span>
                                        <div class="flex items-center space-x-2">
                                            <div class="w-20 bg-gray-200 rounded-full h-2">
                                                <div class="bg-blue-600 h-2 rounded-full" id="modalProgressBar"></div>
                                            </div>
                                            <span class="font-semibold text-blue-600" id="modalProgress">-</span>
                                        </div>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">å¿ƒè·³çŠ¶æ€ï¼š</span>
                                        <span class="font-semibold text-green-600" id="modalHeartbeat">-</span>
                                    </div>
                                </div>
                            </div>

                            <!-- è¿æ¥ä¿¡æ¯å¡ç‰‡ -->
                            <div class="bg-gray-50 rounded-lg p-6">
                                <h3 class="text-lg font-semibold mb-4 text-gray-900" data-i18n="p2pai.dashboard.project.networkConnection">ç½‘ç»œè¿æ¥</h3>
                                <div class="space-y-3">
                                    <div>
                                        <span class="text-gray-600 block mb-2">è¿æ¥åˆ°æ§åˆ¶èŠ‚ç‚¹ï¼š</span>
                                        <div class="space-y-1" id="modalConnectedNodes">
                                            <!-- åŠ¨æ€å¡«å……è¿æ¥çš„èŠ‚ç‚¹ -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- å³ä¾§ï¼šæ€§èƒ½ç›‘æ§å’Œè®­ç»ƒç»Ÿè®¡ -->
                        <div class="space-y-6">
                            <!-- æ€§èƒ½ç›‘æ§å¡ç‰‡ -->
                            <div class="bg-gray-50 rounded-lg p-6">
                                <h3 class="text-lg font-semibold mb-4 text-gray-900" data-i18n="p2pai.dashboard.project.resourceUsage">èµ„æºä½¿ç”¨æƒ…å†µ</h3>
                                <div class="space-y-4">
                                    <!-- CPUä½¿ç”¨ç‡ -->
                                    <div>
                                        <div class="flex justify-between mb-1">
                                            <span class="text-sm text-gray-600">CPUä½¿ç”¨ç‡</span>
                                            <span class="text-sm font-semibold" id="modalCpuValue">-</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-3">
                                            <div class="bg-blue-600 h-3 rounded-full transition-all duration-500" id="modalCpuBar"></div>
                                        </div>
                                    </div>
                                    
                                    <!-- GPUä½¿ç”¨ç‡ -->
                                    <div>
                                        <div class="flex justify-between mb-1">
                                            <span class="text-sm text-gray-600">GPUä½¿ç”¨ç‡</span>
                                            <span class="text-sm font-semibold" id="modalGpuValue">-</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-3">
                                            <div class="bg-green-600 h-3 rounded-full transition-all duration-500" id="modalGpuBar"></div>
                                        </div>
                                    </div>
                                    
                                    <!-- å†…å­˜ä½¿ç”¨ -->
                                    <div>
                                        <div class="flex justify-between mb-1">
                                            <span class="text-sm text-gray-600">å†…å­˜ä½¿ç”¨</span>
                                            <span class="text-sm font-semibold" id="modalMemoryValue">-</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- è®­ç»ƒç»Ÿè®¡å¡ç‰‡ -->
                            <div class="bg-gray-50 rounded-lg p-6" id="modalTrainingStats" style="display: none;">
                                <h3 class="text-lg font-semibold mb-4 text-gray-900" id="modalTrainingStatsTitle" data-i18n="p2pai.dashboard.project.trainingStats">è®­ç»ƒç»Ÿè®¡</h3>
                                <div class="grid grid-cols-2 gap-4 mb-6">
                                    <div class="text-center">
                                        <div class="text-2xl font-bold text-green-600" id="modalAccuracy">-</div>
                                        <div class="text-sm text-gray-600" id="modalAccuracyLabel">å½“å‰å‡†ç¡®ç‡</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-2xl font-bold text-red-600" id="modalLoss">-</div>
                                        <div class="text-sm text-gray-600" id="modalLossLabel">æŸå¤±å€¼</div>
                                    </div>
                                </div>
                                
                                <!-- å†å²è¶‹åŠ¿æ›²çº¿å›¾ -->
                                <div>
                                    <h4 class="text-sm font-semibold mb-2 text-gray-700" id="modalChartTitle">å‡†ç¡®ç‡å†å²è¶‹åŠ¿</h4>
                                    <div class="h-24 bg-white rounded p-3 relative">
                                        <svg width="100%" height="100%" id="modalAccuracyChart" class="overflow-visible">
                                            <!-- SVGæ›²çº¿å›¾å°†åœ¨è¿™é‡Œç”Ÿæˆ -->
                                        </svg>
                                        <div class="absolute bottom-1 left-3 right-3 flex justify-between text-xs text-gray-400">
                                            <span id="modalRoundStart">è½®æ¬¡</span>
                                            <span id="modalRoundEnd">å½“å‰</span>
                                        </div>
                                    </div>
                                    <div class="text-xs text-gray-500 mt-2" id="modalAccuracyHistory">å†å²æ•°æ®</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- åº•éƒ¨æ“ä½œæŒ‰é’® -->
                    <div class="flex justify-end space-x-3 mt-8 pt-6 border-t border-gray-200" id="modalActionButtons">
                        <button id="stopTrainingBtn" onclick="stopTraining()" class="px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors">
                            <span data-i18n="p2pai.dashboard.project.stopTraining">åœæ­¢è®­ç»ƒ</span>
                        </button>
                        <button id="restartTrainingBtn" onclick="restartTraining()" class="px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors">
                            é‡å¯è®­ç»ƒ
                        </button>
                        <button id="exportResultBtn" onclick="exportTrainingResult()" class="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors" style="display: none;">
                            å¯¼å‡ºç»“æœ
                        </button>
                        <button onclick="closeNodeModal()" class="px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition-colors">
                            å…³é—­
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- æ¦‚è§ˆå¡ç‰‡åŒºåŸŸ -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 fade-in-up delay-2">
            <div class="overview-card">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-600">å‚ä¸æ–¹æ€»æ•°</p>
                        <p class="text-2xl font-bold text-gray-900" id="totalNodesCount">12</p>
                    </div>
                    <div class="text-3xl">ğŸ–¥ï¸</div>
                </div>
            </div>
            
            <div class="overview-card">
                <div class="flex items-center justify-between">
                    <div class="flex-1 mr-3">
                        <p class="text-sm text-gray-600">æˆ‘çš„è®­ç»ƒè¿›åº¦</p>
                        <p class="text-2xl font-bold text-red-600" id="avgProgress">97%</p>
                        <!-- è®­ç»ƒè¿›åº¦æ¡ -->
                        <div class="mt-2 w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-gradient-to-r from-red-500 to-red-600 h-2 rounded-full transition-all duration-500" id="myProgressBar" style="width: 97%"></div>
                        </div>
                    </div>
                    <div class="text-3xl">ğŸ“Š</div>
                </div>
            </div>
            
            <div class="overview-card">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-600">ç½‘ç»œå»¶è¿Ÿ</p>
                        <p class="text-2xl font-bold text-green-600" id="networkLatency">23ms</p>
                    </div>
                    <div class="text-3xl">âš¡</div>
                </div>
            </div>
            
            <div class="overview-card">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-600">éšç§ä¿æŠ¤</p>
                        <p class="text-2xl font-bold text-purple-600" id="systemHealth">å¯ç”¨</p>
                    </div>
                    <div class="text-3xl">ğŸ’š</div>
                </div>
            </div>
        </div>

        <!-- èŠ‚ç‚¹è¯¦æƒ…åˆ—è¡¨ -->
        <div class="mt-12 fade-in-up delay-3">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold text-gray-900" data-i18n="p2pai.dashboard.project.participantsList">å¤šæ–¹è®¡ç®—å‚ä¸æ–¹åˆ—è¡¨</h3>
                <div class="flex items-center space-x-4 text-sm text-gray-600">
                    <span><span data-i18n="p2pai.dashboard.project.coordinationNodes">åè°ƒèŠ‚ç‚¹</span>: <span class="font-semibold text-green-600" id="controlNodeCount">3</span></span>
                <span><span data-i18n="p2pai.dashboard.project.participants">å‚ä¸æ–¹</span>: <span class="font-semibold text-blue-600" id="edgeNodeCount">12</span></span>
                <span><span data-i18n="p2pai.dashboard.project.total">æ€»è®¡</span>: <span class="font-semibold text-gray-900" id="totalNodeCount">15</span></span>
                </div>
            </div>
            
            <!-- æ§åˆ¶èŠ‚ç‚¹è¡¨æ ¼ -->
            <div class="mb-8">
                <h4 class="text-lg font-semibold mb-4 text-green-600" data-i18n="p2pai.dashboard.project.controlNodes">æ§åˆ¶èŠ‚ç‚¹ (æœ€å¤š15ä¸ª)</h4>
                <div class="overflow-x-auto bg-white rounded-lg shadow">
                    <table class="min-w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" data-i18n="p2pai.dashboard.project.tableCols.nodeName">èŠ‚ç‚¹åç§°</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" data-i18n="p2pai.dashboard.project.tableCols.role">è§’è‰²</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" data-i18n="p2pai.dashboard.project.tableCols.status">çŠ¶æ€</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" data-i18n="p2pai.dashboard.project.tableCols.user">è´Ÿè´£ç”¨æˆ·</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" data-i18n="p2pai.dashboard.project.tableCols.ipAddress">IPåœ°å€</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" data-i18n="p2pai.dashboard.project.tableCols.connectedNodes">è¿æ¥èŠ‚ç‚¹</th>
                            </tr>
                        </thead>
                        <tbody id="controlNodesTable" class="bg-white divide-y divide-gray-200">
                            <!-- åŠ¨æ€å¡«å…… -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- è¾¹ç¼˜èŠ‚ç‚¹è¡¨æ ¼ -->
            <div class="mb-8">
                <h4 class="text-lg font-semibold mb-4 text-blue-600" data-i18n="p2pai.dashboard.project.participantStatus">å‚ä¸æ–¹èŠ‚ç‚¹çŠ¶æ€</h4>
                <div class="overflow-x-auto bg-white rounded-lg shadow">
                    <table class="min-w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 select-none" onclick="sortEdgeNodes('name')">
                                    <span data-i18n="p2pai.dashboard.project.tableCols.nodeName">èŠ‚ç‚¹åç§°</span> <span id="sort-name" class="ml-1">â‡…</span>
                                </th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 select-none" onclick="sortEdgeNodes('status')">
                                    <span data-i18n="p2pai.dashboard.project.tableCols.status">çŠ¶æ€</span> <span id="sort-status" class="ml-1">â‡…</span>
                                </th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 select-none" onclick="sortEdgeNodes('progress')">
                                    <span data-i18n="p2pai.dashboard.project.tableCols.progress">è®­ç»ƒè¿›åº¦</span> <span id="sort-progress" class="ml-1">â‡…</span>
                                </th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 select-none" onclick="sortEdgeNodes('cpu')">
                                    <span data-i18n="p2pai.dashboard.project.tableCols.cpu">CPU</span> <span id="sort-cpu" class="ml-1">â‡…</span>
                                </th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 select-none" onclick="sortEdgeNodes('memory')">
                                    <span data-i18n="p2pai.dashboard.project.tableCols.memory">å†…å­˜</span> <span id="sort-memory" class="ml-1">â‡…</span>
                                </th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 select-none" onclick="sortEdgeNodes('gpu')">
                                    <span data-i18n="p2pai.dashboard.project.tableCols.gpu">GPU</span> <span id="sort-gpu" class="ml-1">â‡…</span>
                                </th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 select-none" onclick="sortEdgeNodes('heartbeat')">
                                    <span data-i18n="p2pai.dashboard.project.tableCols.heartbeat">æœ€åå¿ƒè·³</span> <span id="sort-heartbeat" class="ml-1">â‡…</span>
                                </th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" data-i18n="p2pai.dashboard.project.tableCols.actions">æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody id="edgeNodesTable" class="bg-white divide-y divide-gray-200">
                            <!-- åŠ¨æ€å¡«å…… -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- è¿”å›ä¸»é¡µæŒ‰é’® -->
    <button class="homepage-return-btn btn-click" onclick="goHome()" title="è¿”å›ä¸»é¡µ">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
        </svg>
    </button>

    <script src="../../shared/js/theme-manager-unified.js?v=20250827"></script>
    <script src="../../shared/js/i18n-manager.js?v=1756649655"></script>
    <!-- <script src="../../shared/js/router-unified.js?v=20250827"></script> -->
    
    <script>
        // ç”Ÿæˆéšæœºæ§åˆ¶èŠ‚ç‚¹é¢œè‰²
        function generateRandomNodeColor() {
            const colors = [
                { fill: '#3b82f6', stroke: '#2563eb' }, // è“è‰²
                { fill: '#8b5cf6', stroke: '#7c3aed' }, // ç´«è‰²
                { fill: '#f59e0b', stroke: '#d97706' }, // æ©™è‰²
                { fill: '#ef4444', stroke: '#dc2626' }, // çº¢è‰²
                { fill: '#10b981', stroke: '#059669' }, // ç»¿è‰²
                { fill: '#f97316', stroke: '#ea580c' }, // æ·±æ©™è‰²
                { fill: '#84cc16', stroke: '#65a30d' }, // é’ç»¿è‰²
                { fill: '#06b6d4', stroke: '#0891b2' }, // é’è‰²
                { fill: '#ec4899', stroke: '#db2777' }, // ç²‰è‰²
                { fill: '#6366f1', stroke: '#4f46e5' }  // é›è“è‰²
            ];
            return colors[Math.floor(Math.random() * colors.length)];
        }

        // è·å–é¡¹ç›®ID
        let projectId = '1'; // é»˜è®¤é¡¹ç›®ID
        
        // åˆå§‹åŒ–æ§åˆ¶èŠ‚ç‚¹é¢œè‰²
        const color1 = generateRandomNodeColor();
        const color2 = generateRandomNodeColor();
        const color3 = generateRandomNodeColor();

        // æ¨¡æ‹Ÿç½‘ç»œæ•°æ®
        const networkData = {
            controlNodes: [
                { id: 'control-1', x: 200, y: 80, name: 'ä¸»æ§èŠ‚ç‚¹1', type: 'master', status: 'active', user: 'ç®¡ç†å‘˜', ip: '192.168.1.100', color: color1.fill, strokeColor: color1.stroke },
                { id: 'control-2', x: 400, y: 80, name: 'ä¸»æ§èŠ‚ç‚¹2', type: 'participant', status: 'active', user: 'åè°ƒå‘˜', ip: '192.168.1.101', color: color2.fill, strokeColor: color2.stroke },
                { id: 'control-3', x: 600, y: 80, name: 'å¤‡ç”¨æ§åˆ¶', type: 'observer', status: 'active', user: 'è§‚å¯Ÿè€…', ip: '192.168.1.102', color: color3.fill, strokeColor: color3.stroke }
            ],
            // æ‰€æœ‰è¾¹ç¼˜èŠ‚ç‚¹ï¼ˆå¯ä»¥æ— é™æ·»åŠ ï¼Œå¯è§†åŒ–ç•Œé¢åªæ˜¾ç¤ºæ´»è·ƒçš„15ä¸ªï¼‰
            allEdgeNodes: [
                // è‡ªå·±çš„èŠ‚ç‚¹ - å¯ä»¥çœ‹åˆ°è¯¦ç»†çŠ¶æ€
                { 
                    id: 'edge-1', name: 'æˆ‘çš„èŠ‚ç‚¹', status: 'training', progress: 97, cpu: 68, memory: '1.8GB', gpu: 83, heartbeat: '5ç§’å‰', priority: 1,
                    url: 'http://192.168.1.101:8080', connectedTo: ['http://192.168.1.100:8080'], 
                    trainingRounds: 245, accuracy: 95.2, loss: 0.048, isOwnNode: true,
                    stats: { cpuHistory: [65, 68, 70, 68], gpuHistory: [80, 83, 85, 83], accuracyHistory: [92.1, 93.5, 94.8, 95.2] }
                },
                // å…¶ä»–å‚ä¸æ–¹çš„èŠ‚ç‚¹ - åªèƒ½çœ‹åˆ°åŸºæœ¬çŠ¶æ€
                { 
                    id: 'edge-3', name: 'å‚ä¸æ–¹A', status: 'online', heartbeat: '1ç§’å‰', priority: 2,
                    url: 'http://192.168.1.103:8080', isOwnNode: false
                },
                { 
                    id: 'edge-5', name: 'å‚ä¸æ–¹B', status: 'online', heartbeat: '3ç§’å‰', priority: 3,
                    url: 'http://192.168.1.105:8080', isOwnNode: false
                },
                { 
                    id: 'edge-8', name: 'å‚ä¸æ–¹C', status: 'online', heartbeat: '1ç§’å‰', priority: 4,
                    url: 'http://192.168.1.108:8080', isOwnNode: false
                },
                { 
                    id: 'edge-9', name: 'å‚ä¸æ–¹D', status: 'online', heartbeat: '2ç§’å‰', priority: 5,
                    url: 'http://192.168.1.109:8080', isOwnNode: false
                },
                { 
                    id: 'edge-11', name: 'å‚ä¸æ–¹E', status: 'online', heartbeat: '1ç§’å‰', priority: 6,
                    url: 'http://192.168.1.111:8080', isOwnNode: false
                },
                { 
                    id: 'edge-13', name: 'å‚ä¸æ–¹F', status: 'online', heartbeat: '2ç§’å‰', priority: 7,
                    url: 'http://192.168.1.113:8080', isOwnNode: false
                },
                { 
                    id: 'edge-14', name: 'å‚ä¸æ–¹G', status: 'online', heartbeat: '1ç§’å‰', priority: 8,
                    url: 'http://192.168.1.114:8080', isOwnNode: false
                },
                // å…¶ä»–åœ¨çº¿çš„å‚ä¸æ–¹
                { id: 'edge-4', name: 'å‚ä¸æ–¹H', status: 'online', heartbeat: '10ç§’å‰', priority: 9, isOwnNode: false },
                { id: 'edge-10', name: 'å‚ä¸æ–¹I', status: 'online', heartbeat: '8ç§’å‰', priority: 10, isOwnNode: false },
                { id: 'edge-15', name: 'å‚ä¸æ–¹J', status: 'offline', heartbeat: '5åˆ†é’Ÿå‰', priority: 11, isOwnNode: false },
                { id: 'edge-16', name: 'å‚ä¸æ–¹K', status: 'online', heartbeat: '12ç§’å‰', priority: 12, isOwnNode: false },
                // ä¸€äº›å·²ç¦»çº¿çš„å‚ä¸æ–¹
                { 
                    id: 'edge-2', name: 'å‚ä¸æ–¹L', status: 'offline', heartbeat: '10åˆ†é’Ÿå‰', priority: 13, 
                    url: 'http://192.168.1.102:8080', isOwnNode: false
                },
                { 
                    id: 'edge-7', name: 'å‚ä¸æ–¹M', status: 'offline', heartbeat: '15åˆ†é’Ÿå‰', priority: 14,
                    url: 'http://192.168.1.107:8080', isOwnNode: false
                },
                { 
                    id: 'edge-12', name: 'å‚ä¸æ–¹N', status: 'offline', heartbeat: '8åˆ†é’Ÿå‰', priority: 15,
                    url: 'http://192.168.1.112:8080', isOwnNode: false
                },
                // é”™è¯¯æˆ–ç¦»çº¿çš„å‚ä¸æ–¹
                { id: 'edge-6', name: 'å‚ä¸æ–¹O', status: 'offline', heartbeat: '30åˆ†é’Ÿå‰', priority: 16, isOwnNode: false },
                // æ›´å¤šå‚ä¸æ–¹...
                { id: 'edge-17', name: 'å‚ä¸æ–¹P', status: 'online', heartbeat: '1ç§’å‰', priority: 17, isOwnNode: false },
                { id: 'edge-18', name: 'å‚ä¸æ–¹Q', status: 'online', heartbeat: '20ç§’å‰', priority: 18, isOwnNode: false },
                { id: 'edge-19', name: 'å‚ä¸æ–¹R', status: 'online', heartbeat: '3ç§’å‰', priority: 19, isOwnNode: false },
                { id: 'edge-20', name: 'å‚ä¸æ–¹S', status: 'online', heartbeat: '18ç§’å‰', priority: 20, isOwnNode: false }
            ],
            // å½“å‰åœ¨å¯è§†åŒ–ç•Œé¢æ˜¾ç¤ºçš„èŠ‚ç‚¹ï¼ˆæœ€å¤š15ä¸ªï¼‰
            edgeNodes: []
        };
        
        let selectedNode = null;
        let animationId = null;
        let nodePositions = []; // é¢„å®šä¹‰çš„èŠ‚ç‚¹ä½ç½®
        
        // æ’åºç›¸å…³å˜é‡
        let currentSortField = 'priority';
        let currentSortDirection = 'asc';
        
        // é¢„å®šä¹‰å¯è§†åŒ–èŠ‚ç‚¹ä½ç½®ï¼ˆæœ€å¤š15ä¸ªä½ç½®ï¼‰
        function initializeNodePositions() {
            nodePositions = [
                { x: 120, y: 280 }, { x: 200, y: 320 }, { x: 280, y: 360 }, { x: 360, y: 320 }, { x: 440, y: 280 },
                { x: 520, y: 320 }, { x: 600, y: 360 }, { x: 680, y: 320 }, { x: 160, y: 440 }, { x: 320, y: 480 },
                { x: 480, y: 440 }, { x: 640, y: 480 }, { x: 240, y: 520 }, { x: 400, y: 540 }, { x: 560, y: 520 }
            ];
        }
        
        // P2PAIå¯è§†åŒ–èŠ‚ç‚¹é€‰æ‹©ï¼šä¼˜å…ˆæ˜¾ç¤ºè‡ªå·±çš„èŠ‚ç‚¹
        function updateVisualizedNodes() {
            // ç¡®ä¿nodePositionså·²åˆå§‹åŒ–
            if (!nodePositions || nodePositions.length === 0) {
                initializeNodePositions();
            }
            
            // P2PAIç‰¹æ€§ï¼šä¼˜å…ˆæ˜¾ç¤ºè‡ªå·±çš„èŠ‚ç‚¹å’Œåœ¨çº¿çš„å…¶ä»–èŠ‚ç‚¹
            let selectedNodes = [];
            
            // é¦–å…ˆæ·»åŠ è‡ªå·±çš„èŠ‚ç‚¹ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
            const myNode = networkData.allEdgeNodes.find(node => node.isOwnNode);
            if (myNode) {
                selectedNodes.push(myNode);
            }
            
            // ç„¶åæ·»åŠ å…¶ä»–åœ¨çº¿èŠ‚ç‚¹ï¼Œæœ€å¤š14ä¸ªï¼ˆä¸ºè‡ªå·±çš„èŠ‚ç‚¹ç•™ä¸€ä¸ªä½ç½®ï¼‰
            const otherOnlineNodes = networkData.allEdgeNodes
                .filter(node => !node.isOwnNode && node.status === 'online')
                .slice(0, 14);
            
            selectedNodes = selectedNodes.concat(otherOnlineNodes);
            
            // å¦‚æœè¿˜æœ‰ç©ºä½ï¼Œæ·»åŠ ä¸€äº›ç¦»çº¿èŠ‚ç‚¹
            if (selectedNodes.length < 15) {
                const offlineNodes = networkData.allEdgeNodes
                    .filter(node => !node.isOwnNode && node.status === 'offline')
                    .slice(0, 15 - selectedNodes.length);
                selectedNodes = selectedNodes.concat(offlineNodes);
            }
            
            // ä¸ºèŠ‚ç‚¹åˆ†é…å¯è§†åŒ–ä½ç½®
            const newVisualizedNodes = selectedNodes.slice(0, 15).map((node, index) => {
                const position = nodePositions[index] || { x: 200 + (index * 60), y: 200 + (Math.floor(index / 5) * 80) };
                return {
                    ...node,
                    x: position.x,
                    y: position.y,
                    visualIndex: index
                };
            });
            
            // æ£€æŸ¥èŠ‚ç‚¹å˜åŒ–ï¼Œæ·»åŠ æ·¡å…¥æ·¡å‡ºåŠ¨ç”»
            const oldIds = networkData.edgeNodes.map(n => n.id);
            const newIds = newVisualizedNodes.map(n => n.id);
            
            // æ ‡è®°æ·¡å‡ºçš„èŠ‚ç‚¹
            networkData.edgeNodes.forEach(node => {
                if (!newIds.includes(node.id)) {
                    node.fadeOut = true;
                }
            });
            
            // æ ‡è®°æ·¡å…¥çš„èŠ‚ç‚¹
            newVisualizedNodes.forEach(node => {
                if (!oldIds.includes(node.id)) {
                    node.fadeIn = true;
                }
            });
            
            // æ›´æ–°å¯è§†åŒ–èŠ‚ç‚¹åˆ—è¡¨
            networkData.edgeNodes = newVisualizedNodes;
        }
        
        // æ¨¡æ‹Ÿé¡¹ç›®æ•°æ®ï¼ˆæ ¹æ®é¡¹ç›®IDè·å–ä¸åŒæ•°æ®ï¼‰
        const projectsData = {
            1: {
                name: 'æ™ºèƒ½åˆ¶é€ ç›‘æ§ç³»ç»Ÿ',
                description: 'åŸºäºEdgeAIçš„å·¥å‚è®¾å¤‡å®æ—¶ç›‘æ§å’Œé¢„æµ‹ç»´æŠ¤ç³»ç»Ÿï¼Œå®ç°è®¾å¤‡çŠ¶æ€æ™ºèƒ½åˆ†æå’Œæ•…éšœé¢„è­¦ã€‚',
                status: 'training',
                created: '2024-01-15',
                updated: '2å°æ—¶å‰',
                progress: 75,
                aiModel: 'CNNæ·±åº¦å­¦ä¹ ',
                strategy: 'è”é‚¦å­¦ä¹ ',
                targetAccuracy: 'â‰¥90%',
                estimatedTime: '2å¤©å'
            },
            2: {
                name: 'æ™ºæ…§åŸå¸‚äº¤é€šä¼˜åŒ–',
                description: 'åˆ©ç”¨EdgeAIæŠ€æœ¯å®ç°åŸå¸‚äº¤é€šæµé‡å®æ—¶åˆ†æï¼Œæ™ºèƒ½ä¿¡å·ç¯æ§åˆ¶å’Œè·¯çº¿ä¼˜åŒ–æ¨èç³»ç»Ÿã€‚',
                status: 'active',
                created: '2024-02-10',
                updated: '30åˆ†é’Ÿå‰',
                progress: 45,
                aiModel: 'RNNå¾ªç¯ç¥ç»ç½‘ç»œ',
                strategy: 'å¼ºåŒ–å­¦ä¹ ',
                targetAccuracy: 'â‰¥85%',
                estimatedTime: '5å¤©å'
            },
            3: {
                name: 'åŒ»ç–—å½±åƒæ™ºèƒ½è¯Šæ–­',
                description: 'åŸºäºæ·±åº¦å­¦ä¹ çš„åŒ»ç–—å½±åƒè‡ªåŠ¨è¯†åˆ«å’Œè¯Šæ–­è¾…åŠ©ç³»ç»Ÿï¼Œæå‡è¯Šæ–­å‡†ç¡®æ€§å’Œæ•ˆç‡ã€‚',
                status: 'completed',
                created: '2024-01-20',
                updated: '1å¤©å‰',
                progress: 100,
                aiModel: 'ResNetæ·±åº¦æ®‹å·®ç½‘ç»œ',
                strategy: 'è¿ç§»å­¦ä¹ ',
                targetAccuracy: 'â‰¥95%',
                estimatedTime: 'å·²å®Œæˆ'
            }
        };
        
        // åˆå§‹åŒ–é¡¹ç›®ä¿¡æ¯
        function initializeProjectInfo() {
            // å®‰å…¨è®¾ç½®å…ƒç´ æ–‡æœ¬å†…å®¹
            const safeSetText = (id, text) => {
                const element = document.getElementById(id);
                if (element) element.textContent = text;
            };
            
            // å®‰å…¨è®¾ç½®å…ƒç´ ç±»å
            const safeSetClass = (id, className) => {
                const element = document.getElementById(id);
                if (element) element.className = className;
            };
            
            const project = projectsData[projectId] || projectsData[1];
            
            // æ›´æ–°é¡¹ç›®åŸºæœ¬ä¿¡æ¯
            safeSetText('projectTitle', project.name);
            safeSetText('projectDescription', project.description);
            safeSetText('projectCreated', project.created);
            safeSetText('projectUpdated', project.updated);
            
            // æ›´æ–°çŠ¶æ€
            const statusColors = {
                'training': { color: 'text-blue-600', text: 'è®­ç»ƒä¸­', bgColor: 'bg-blue-500' },
                'active': { color: 'text-green-600', text: 'è¿è¡Œä¸­', bgColor: 'bg-green-500' },
                'completed': { color: 'text-green-600', text: 'å·²å®Œæˆ', bgColor: 'bg-green-500' },
                'paused': { color: 'text-yellow-600', text: 'æš‚åœ', bgColor: 'bg-yellow-500' },
                'error': { color: 'text-red-600', text: 'é”™è¯¯', bgColor: 'bg-red-500' }
            };
            
            const statusInfo = statusColors[project.status] || statusColors['training'];
            safeSetClass('projectStatus', `font-semibold ml-2 ${statusInfo.color}`);
            safeSetText('projectStatus', statusInfo.text);
            
            // æ›´æ–°çŠ¶æ€æŒ‡ç¤ºå™¨
            safeSetClass('statusDot', `w-2 h-2 rounded-full mr-2 flex-shrink-0 ${statusInfo.bgColor}`);
            
            // æ›´æ–°è¿›åº¦åœ†ç¯
            const progressCircle = document.getElementById('progressCircle');
            if (progressCircle) {
                const circumference = 2 * Math.PI * 40; // r=40
                const offset = circumference - (project.progress / 100) * circumference;
                progressCircle.style.strokeDashoffset = offset;
                const overallProgress = document.getElementById('overallProgress');
                if (overallProgress) {
                    overallProgress.textContent = `${project.progress}%`;
                }
            }
            
            // æ›´æ–°å¿«é€Ÿç»Ÿè®¡ - å®‰å…¨ç‰ˆæœ¬
            const totalNodes = networkData.controlNodes.length + networkData.allEdgeNodes.length;
            const onlineNodes = networkData.allEdgeNodes.filter(n => n.status === 'online').length;
            const trainingNodes = 1; // åªæœ‰æˆ‘ä»¬çš„èŠ‚ç‚¹åœ¨è®­ç»ƒ
            
            safeSetText('quickNodeCount', totalNodes);
            safeSetText('quickOnlineCount', onlineNodes);
            
            // æ›´æ–°é¡¹ç›®é…ç½®
            safeSetText('aiModelType', project.aiModel);
            safeSetText('trainingStrategy', project.strategy);
            safeSetText('targetAccuracy', project.targetAccuracy);
            safeSetText('estimatedTime', project.estimatedTime);
        }
        
        // é¡µé¢åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // è·å–é¡¹ç›®IDï¼ˆå¦‚æœæœ‰ï¼‰
            const urlParams = new URLSearchParams(window.location.search);
            projectId = urlParams.get('projectId') || localStorage.getItem('currentProjectId') || '1';
            
            const projectText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.project.projectName') : 'é¡¹ç›®';
                document.getElementById('projectName').textContent = `- ${projectText} ${projectId}`;
            initializeProjectInfo(); // åˆå§‹åŒ–é¡¹ç›®ä¿¡æ¯
            initializeVisualization();
            startRealTimeUpdates();
        });
        
        // å†»ç»“èŠ‚ç‚¹ä½ç½®ï¼Œé˜²æ­¢æ„å¤–ä¿®æ”¹
        function freezeNodePositions() {
            networkData.controlNodes.forEach(node => {
                const originalX = node.x;
                const originalY = node.y;
                Object.defineProperty(node, 'x', { 
                    value: originalX, 
                    writable: false, 
                    configurable: false 
                });
                Object.defineProperty(node, 'y', { 
                    value: originalY, 
                    writable: false, 
                    configurable: false 
                });
            });
            
            networkData.edgeNodes.forEach(node => {
                const originalX = node.x;
                const originalY = node.y;
                Object.defineProperty(node, 'x', { 
                    value: originalX, 
                    writable: false, 
                    configurable: false 
                });
                Object.defineProperty(node, 'y', { 
                    value: originalY, 
                    writable: false, 
                    configurable: false 
                });
            });
        }

        // åˆå§‹åŒ–å¯è§†åŒ–
        function initializeVisualization() {
            initializeNodePositions(); // é¦–å…ˆåˆå§‹åŒ–èŠ‚ç‚¹ä½ç½®
            updateVisualizedNodes(); // åˆå§‹åŒ–å¯è§†åŒ–èŠ‚ç‚¹
            freezeNodePositions(); // å†»ç»“èŠ‚ç‚¹ä½ç½®
            drawNodes();
            drawConnections();
            updateStats();
            fillNodeTables(); // å¡«å……èŠ‚ç‚¹è¡¨æ ¼
        }
        
        // ç»˜åˆ¶èŠ‚ç‚¹
        function drawNodes() {
            const nodesGroup = document.getElementById('nodes');
            const labelsGroup = document.getElementById('labels');
            
            // æ¸…ç©ºç°æœ‰èŠ‚ç‚¹
            nodesGroup.innerHTML = '';
            labelsGroup.innerHTML = '';
            
            // ç»˜åˆ¶æ§åˆ¶èŠ‚ç‚¹
            networkData.controlNodes.forEach(node => {
                // èŠ‚ç‚¹åœ†åœˆ
                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', node.x);
                circle.setAttribute('cy', node.y);
                circle.setAttribute('r', 25);
                circle.setAttribute('class', 'control-node');
                circle.setAttribute('data-id', node.id);
                // è®¾ç½®èŠ‚ç‚¹ç‰¹å®šé¢œè‰²
                console.log(`è®¾ç½®æ§åˆ¶èŠ‚ç‚¹ ${node.id} é¢œè‰²: fill=${node.color}, stroke=${node.strokeColor}`);
                circle.style.setProperty('fill', node.color, 'important');
                circle.style.setProperty('stroke', node.strokeColor, 'important');
                // å¤‡ç”¨æ–¹æ³•ï¼šç›´æ¥è®¾ç½®å±æ€§
                circle.setAttribute('fill', node.color);
                circle.setAttribute('stroke', node.strokeColor);
                circle.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    showNodeDetails(node, 'control');
                });
                circle.style.pointerEvents = 'auto';
                circle.style.cursor = 'pointer';
                nodesGroup.appendChild(circle);
                
                // èŠ‚ç‚¹æ ‡ç­¾
                const label = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                label.setAttribute('x', node.x);
                label.setAttribute('y', node.y - 35);
                label.setAttribute('class', 'node-label');
                label.textContent = getTranslatedNodeName(node.name);
                labelsGroup.appendChild(label);
                
                // ç§»é™¤çŠ¶æ€æŒ‡ç¤ºå™¨ - ä¿æŒèŠ‚ç‚¹ç®€æ´
            });
            
            // ç»˜åˆ¶è¾¹ç¼˜èŠ‚ç‚¹
            networkData.edgeNodes.forEach((node, index) => {
                // èŠ‚ç‚¹åœ†åœˆ
                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', node.x);
                circle.setAttribute('cy', node.y);
                circle.setAttribute('r', 18);
                
                // æ ¹æ®P2PAIç‰¹æ€§è®¾ç½®èŠ‚ç‚¹æ ·å¼
                let nodeClass = 'edge-node';
                if (node.isOwnNode) {
                    // è‡ªå·±çš„èŠ‚ç‚¹ - çº¢è‰²
                    nodeClass += ' own-node';
                } else {
                    // å…¶ä»–èŠ‚ç‚¹æ ¹æ®åœ¨çº¿çŠ¶æ€
                    if (node.status === 'online') {
                        nodeClass += ' other-online';
                    } else {
                        nodeClass += ' other-offline';
                    }
                }
                
                // æ·»åŠ åŠ¨ç”»æ•ˆæœ
                if (node.fadeIn) {
                    nodeClass += ' node-fade-in';
                    // æ¸…é™¤æ ‡è®°
                    setTimeout(() => {
                        node.fadeIn = false;
                    }, 600);
                }
                if (node.fadeOut) {
                    nodeClass += ' node-fade-out';
                    // æ¸…é™¤æ·¡å‡ºæ ‡è®°
                    setTimeout(() => {
                        node.fadeOut = false;
                    }, 400);
                }
                
                circle.setAttribute('class', nodeClass);
                circle.setAttribute('data-id', node.id);
                circle.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    // P2PAIç‰¹æ€§ï¼šåªæœ‰è‡ªå·±çš„èŠ‚ç‚¹å¯ä»¥æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
                    if (node.isOwnNode) {
                        showNodeDetails(node, 'edge');
                    } else {
                        // å…¶ä»–èŠ‚ç‚¹åªæ˜¾ç¤ºåŸºæœ¬è¿æ¥ä¿¡æ¯
                        showBasicNodeInfo(node);
                    }
                });
                // ç¡®ä¿èŠ‚ç‚¹ä¸ä¼šè¢«æ‹–æ‹½æˆ–ç§»åŠ¨
                circle.style.pointerEvents = 'auto';
                circle.style.cursor = 'pointer';
                nodesGroup.appendChild(circle);
                
                // è¿›åº¦ç¯ - åªå¯¹è‡ªå·±çš„èŠ‚ç‚¹æ˜¾ç¤º
                if (node.isOwnNode && node.status === 'training' && node.progress > 0) {
                    const progressCircle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                    progressCircle.setAttribute('cx', node.x);
                    progressCircle.setAttribute('cy', node.y);
                    progressCircle.setAttribute('r', 15);
                    progressCircle.setAttribute('class', 'progress-ring active');
                    progressCircle.setAttribute('stroke-dasharray', '94.2');
                    progressCircle.setAttribute('stroke-dashoffset', 94.2 * (1 - node.progress / 100));
                    nodesGroup.appendChild(progressCircle);
                }
                
                // èŠ‚ç‚¹æ ‡ç­¾
                const label = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                label.setAttribute('x', node.x);
                label.setAttribute('y', node.y + 35);
                label.setAttribute('class', 'node-label');
                label.textContent = getTranslatedNodeName(node.name);
                labelsGroup.appendChild(label);
                
                // è¿›åº¦æ–‡å­—
                if (node.status === 'training') {
                    const progressText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    progressText.setAttribute('x', node.x);
                    progressText.setAttribute('y', node.y + 3);
                    progressText.setAttribute('class', 'node-label');
                    progressText.setAttribute('font-size', '10');
                    progressText.textContent = `${node.progress}%`;
                    labelsGroup.appendChild(progressText);
                }
            });
        }
        
        // ç»˜åˆ¶è¿æ¥çº¿
        function drawConnections() {
            const connectionsGroup = document.getElementById('connections');
            connectionsGroup.innerHTML = '';
            
            // ä¸ºæ¯ä¸ªè¾¹ç¼˜èŠ‚ç‚¹åˆ†é…æ§åˆ¶èŠ‚ç‚¹ï¼ˆå®é™…ç½‘ç»œè¿æ¥é€»è¾‘ï¼‰
            networkData.edgeNodes.forEach((edgeNode, index) => {
                // åªä¸ºè®­ç»ƒä¸­å’Œæœªå®Œæˆçš„èŠ‚ç‚¹ç»˜åˆ¶è¿æ¥çº¿
                if (edgeNode.status === 'completed') {
                    return; // è·³è¿‡å·²å®Œæˆçš„èŠ‚ç‚¹
                }
                
                // æ ¹æ®èŠ‚ç‚¹ç´¢å¼•åˆ†é…æ§åˆ¶èŠ‚ç‚¹ï¼ˆæ¨¡æ‹Ÿå®é™…ç½‘ç»œè¿æ¥ï¼‰
                let controlNodeIndex = 0; // é»˜è®¤è¿æ¥åˆ°ä¸»æ§èŠ‚ç‚¹1
                
                // ç®€å•çš„è´Ÿè½½å‡è¡¡åˆ†é…é€»è¾‘
                if (index < 4) {
                    controlNodeIndex = 0; // å‰4ä¸ªèŠ‚ç‚¹è¿æ¥åˆ°ä¸»æ§èŠ‚ç‚¹1
                } else if (index < 8) {
                    controlNodeIndex = 1; // ä¸­é—´4ä¸ªèŠ‚ç‚¹è¿æ¥åˆ°ä¸»æ§èŠ‚ç‚¹2  
                } else {
                    controlNodeIndex = 2; // å‰©ä½™èŠ‚ç‚¹è¿æ¥åˆ°å¤‡ç”¨æ§åˆ¶èŠ‚ç‚¹
                }
                
                // ç¡®ä¿æ§åˆ¶èŠ‚ç‚¹å­˜åœ¨
                if (controlNodeIndex < networkData.controlNodes.length) {
                    const controlNode = networkData.controlNodes[controlNodeIndex];
                    
                    // åˆ›å»ºè¿æ¥çº¿
                    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    line.setAttribute('x1', controlNode.x);
                    line.setAttribute('y1', controlNode.y);
                    line.setAttribute('x2', edgeNode.x);
                    line.setAttribute('y2', edgeNode.y);
                    
                    // è®¾ç½®è¿æ¥çº¿æ ·å¼ï¼ˆé»˜è®¤é€æ˜ï¼‰
                    let lineClass = 'connection-line';
                    
                    line.setAttribute('class', lineClass);
                    line.setAttribute('data-from', controlNode.id);
                    line.setAttribute('data-to', edgeNode.id);
                    line.setAttribute('data-status', edgeNode.status);
                    
                    connectionsGroup.appendChild(line);
                }
            });
        }
        
        // è§¦å‘æ•°æ®ä¼ è¾“åŠ¨ç”»
        function triggerDataTransmissions() {
            const connections = document.querySelectorAll('.connection-line');
            const trainingConnections = Array.from(connections).filter(line => {
                const edgeNodeId = line.getAttribute('data-to');
                const edgeNode = networkData.edgeNodes.find(n => n.id === edgeNodeId);
                return edgeNode && edgeNode.status === 'training';
            });
            
            if (trainingConnections.length === 0) return;
            
            // é«˜é¢‘æµ‹è¯•: 2-5ä¸ªè¿æ¥ï¼Œ80%æ¦‚ç‡
            const transmissionCount = Math.min(
                Math.floor(Math.random() * 4) + 2, // 2-5ä¸ª
                trainingConnections.length
            );
            
            // éšæœºé€‰æ‹©è¿æ¥è¿›è¡Œæ•°æ®ä¼ è¾“
            const shuffled = trainingConnections.sort(() => 0.5 - Math.random());
            const selectedConnections = shuffled.slice(0, transmissionCount);
            
            selectedConnections.forEach((line, index) => {
                // éšæœºå»¶è¿Ÿå¯åŠ¨ï¼Œé¿å…æ‰€æœ‰åŠ¨ç”»åŒæ—¶å¼€å§‹
                const startDelay = Math.random() * 2000; // 0-2ç§’å»¶è¿Ÿ
                
                setTimeout(() => {
                    // ç¡®ä¿è¿æ¥çº¿ä»ç„¶å­˜åœ¨ä¸”å¯¹åº”èŠ‚ç‚¹ä»åœ¨è®­ç»ƒ
                    if (document.contains(line)) {
                        const edgeNodeId = line.getAttribute('data-to');
                        const edgeNode = networkData.edgeNodes.find(n => n.id === edgeNodeId);
                        
                        if (edgeNode && edgeNode.status === 'training') {
                            // åˆ›å»ºæµåŠ¨çš„æ•°æ®æ®µ
                            const dataSegment = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                            dataSegment.setAttribute('x1', line.getAttribute('x1'));
                            dataSegment.setAttribute('y1', line.getAttribute('y1'));
                            dataSegment.setAttribute('x2', line.getAttribute('x2'));
                            dataSegment.setAttribute('y2', line.getAttribute('y2'));
                            dataSegment.setAttribute('class', 'data-segment flow-down');
                            
                            // æ·»åŠ åˆ°è¿æ¥ç»„
                            const connectionsGroup = document.getElementById('connections');
                            connectionsGroup.appendChild(dataSegment);
                            
                            // 4ç§’åæ¸…ç†åŠ¨ç”»å…ƒç´ 
                            setTimeout(() => {
                                if (dataSegment.parentNode) {
                                    dataSegment.parentNode.removeChild(dataSegment);
                                }
                            }, 4000);
                        }
                    }
                }, startDelay);
            });
        }
        
        // é€šè¿‡èŠ‚ç‚¹IDæ‰“å¼€èŠ‚ç‚¹è¯¦æƒ…
        function openNodeDetails(nodeId) {
            console.log('Opening node details for:', nodeId);
            const node = networkData.allEdgeNodes.find(n => n.id === nodeId);
            if (node) {
                console.log('Found node:', node);
                showNodeModal(node);
            } else {
                console.log('Node not found:', nodeId);
            }
        }

        // æ˜¾ç¤ºæ–°çš„æ¨¡æ€å¡ç‰‡
        function showNodeModal(node) {
            const modal = document.getElementById('nodeModal');
            
            // å¡«å……åŸºç¡€ä¿¡æ¯
            document.getElementById('modalNodeTitle').textContent = getTranslatedNodeName(node.name);
            document.getElementById('modalNodeStatus').textContent = getStatusText(node.status);
            document.getElementById('modalNodeName').textContent = getTranslatedNodeName(node.name);
            const notConfiguredText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.project.notConfigured') : 'æœªé…ç½®';
                document.getElementById('modalNodeUrl').textContent = node.url || notConfiguredText;
            document.getElementById('modalTrainingRounds').textContent = node.trainingRounds || 0;
            document.getElementById('modalProgress').textContent = `${node.progress}%`;
            document.getElementById('modalProgressBar').style.width = `${node.progress}%`;
            const unknownText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.project.unknown') : 'æœªçŸ¥';
                document.getElementById('modalHeartbeat').textContent = node.heartbeat || unknownText;
            
            // å¡«å……è¿æ¥èŠ‚ç‚¹ä¿¡æ¯
            const connectedNodesDiv = document.getElementById('modalConnectedNodes');
            connectedNodesDiv.innerHTML = '';
            if (node.connectedTo && node.connectedTo.length > 0) {
                node.connectedTo.forEach(url => {
                    const nodeDiv = document.createElement('div');
                    nodeDiv.className = 'flex items-center space-x-2 bg-white px-3 py-2 rounded border';
                    nodeDiv.innerHTML = `
                        <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                        <span class="font-mono text-sm">${url}</span>
                        <div class="ml-auto text-xs text-green-600">å·²è¿æ¥</div>
                    `;
                    connectedNodesDiv.appendChild(nodeDiv);
                });
            } else {
                connectedNodesDiv.innerHTML = '<div class="text-gray-500 text-sm">æ— è¿æ¥</div>';
            }
            
            // å¡«å……èµ„æºä½¿ç”¨æƒ…å†µ
            document.getElementById('modalCpuValue').textContent = `${node.cpu.toFixed(2)}%`;
            document.getElementById('modalCpuBar').style.width = `${node.cpu}%`;
            document.getElementById('modalGpuValue').textContent = `${node.gpu.toFixed(2)}%`;
            document.getElementById('modalGpuBar').style.width = `${node.gpu}%`;
            document.getElementById('modalMemoryValue').textContent = node.memory || unknownText;
            
            // å¦‚æœæ˜¯è®­ç»ƒèŠ‚ç‚¹æˆ–å·²å®Œæˆè®­ç»ƒçš„èŠ‚ç‚¹ï¼Œæ˜¾ç¤ºè®­ç»ƒç»Ÿè®¡
            const trainingStatsDiv = document.getElementById('modalTrainingStats');
            if ((node.status === 'training' || node.status === 'completed') && node.accuracy && node.loss) {
                trainingStatsDiv.style.display = 'block';
                
                // æ ¹æ®èŠ‚ç‚¹çŠ¶æ€æ›´æ–°æ ‡é¢˜å’Œæ ‡ç­¾
                const statsTitle = document.getElementById('modalTrainingStatsTitle');
                const accuracyLabel = document.getElementById('modalAccuracyLabel');
                const lossLabel = document.getElementById('modalLossLabel');
                const chartTitle = document.getElementById('modalChartTitle');
                
                if (node.status === 'completed') {
                    const historyResultsText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.project.historyResults') : 'å†å²è®­ç»ƒç»“æœ';
                const finalAccuracyText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.project.finalAccuracy') : 'æœ€ç»ˆå‡†ç¡®ç‡';
                const finalLossText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.project.finalLoss') : 'æœ€ç»ˆæŸå¤±å€¼';
                const trainingCurveText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.project.trainingCurve') : 'è®­ç»ƒè¿‡ç¨‹æ›²çº¿';
                
                statsTitle.textContent = historyResultsText;
                accuracyLabel.textContent = finalAccuracyText;
                lossLabel.textContent = finalLossText;
                chartTitle.textContent = trainingCurveText;
                } else {
                    const trainingStatsText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.project.trainingStats') : 'è®­ç»ƒç»Ÿè®¡';
                const currentAccuracyText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.project.currentAccuracy') : 'å½“å‰å‡†ç¡®ç‡';
                const currentLossText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.project.currentLoss') : 'å½“å‰æŸå¤±å€¼';
                const accuracyTrendText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.project.accuracyTrend') : 'å‡†ç¡®ç‡å†å²è¶‹åŠ¿';
                
                statsTitle.textContent = trainingStatsText;
                accuracyLabel.textContent = currentAccuracyText;
                lossLabel.textContent = currentLossText;
                chartTitle.textContent = accuracyTrendText;
                }
                
                document.getElementById('modalAccuracy').textContent = `${node.accuracy.toFixed(2)}%`;
                document.getElementById('modalLoss').textContent = node.loss.toFixed(2);
                
                // æ˜¾ç¤ºå†å²è¶‹åŠ¿æ›²çº¿
                if (node.stats && node.stats.accuracyHistory && node.stats.accuracyHistory.length > 1) {
                    const chartSvg = document.getElementById('modalAccuracyChart');
                    const svgRect = chartSvg.getBoundingClientRect();
                    const width = svgRect.width || 280;
                    const height = svgRect.height || 60;
                    const padding = 10;
                    const chartWidth = width - 2 * padding;
                    const chartHeight = height - 2 * padding;
                    
                    // æ¸…ç©ºSVG
                    chartSvg.innerHTML = '';
                    
                    const accuracyData = node.stats.accuracyHistory;
                    const rounds = accuracyData.length;
                    const maxAccuracy = Math.max(...accuracyData);
                    const minAccuracy = Math.min(...accuracyData);
                    const accuracyRange = maxAccuracy - minAccuracy || 10; // é¿å…é™¤ä»¥0
                    
                    // è®¡ç®—ç‚¹çš„åæ ‡
                    const points = accuracyData.map((accuracy, index) => {
                        const x = padding + (index / (rounds - 1)) * chartWidth;
                        const y = padding + ((maxAccuracy - accuracy) / accuracyRange) * chartHeight;
                        return { x, y, accuracy, round: index + 1 };
                    });
                    
                    // åˆ›å»ºè·¯å¾„å­—ç¬¦ä¸²
                    let pathD = `M ${points[0].x} ${points[0].y}`;
                    for (let i = 1; i < points.length; i++) {
                        // ä½¿ç”¨è´å¡å°”æ›²çº¿åˆ›å»ºå¹³æ»‘æ›²çº¿
                        const prevPoint = points[i - 1];
                        const currentPoint = points[i];
                        const controlPointX1 = prevPoint.x + (currentPoint.x - prevPoint.x) / 3;
                        const controlPointY1 = prevPoint.y;
                        const controlPointX2 = currentPoint.x - (currentPoint.x - prevPoint.x) / 3;
                        const controlPointY2 = currentPoint.y;
                        
                        pathD += ` C ${controlPointX1} ${controlPointY1}, ${controlPointX2} ${controlPointY2}, ${currentPoint.x} ${currentPoint.y}`;
                    }
                    
                    // åˆ›å»ºæ¸å˜å®šä¹‰
                    const defs = document.createElementNS('http://www.w3.org/2000/svg', 'defs');
                    const gradient = document.createElementNS('http://www.w3.org/2000/svg', 'linearGradient');
                    gradient.setAttribute('id', 'accuracyGradient');
                    gradient.setAttribute('x1', '0%');
                    gradient.setAttribute('y1', '0%');
                    gradient.setAttribute('x2', '0%');
                    gradient.setAttribute('y2', '100%');
                    
                    const stop1 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');
                    stop1.setAttribute('offset', '0%');
                    stop1.setAttribute('style', 'stop-color:rgb(34,197,94);stop-opacity:0.8');
                    
                    const stop2 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');
                    stop2.setAttribute('offset', '100%');
                    stop2.setAttribute('style', 'stop-color:rgb(34,197,94);stop-opacity:0.1');
                    
                    gradient.appendChild(stop1);
                    gradient.appendChild(stop2);
                    defs.appendChild(gradient);
                    chartSvg.appendChild(defs);
                    
                    // åˆ›å»ºå¡«å……åŒºåŸŸè·¯å¾„
                    const fillPath = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                    const fillPathD = pathD + ` L ${points[points.length - 1].x} ${height - padding} L ${points[0].x} ${height - padding} Z`;
                    fillPath.setAttribute('d', fillPathD);
                    fillPath.setAttribute('fill', 'url(#accuracyGradient)');
                    chartSvg.appendChild(fillPath);
                    
                    // åˆ›å»ºæ›²çº¿è·¯å¾„
                    const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                    path.setAttribute('d', pathD);
                    path.setAttribute('stroke', 'rgb(34,197,94)');
                    path.setAttribute('stroke-width', '2');
                    path.setAttribute('fill', 'none');
                    path.setAttribute('stroke-linecap', 'round');
                    path.setAttribute('stroke-linejoin', 'round');
                    chartSvg.appendChild(path);
                    
                    // æ·»åŠ æ•°æ®ç‚¹
                    points.forEach((point, index) => {
                        const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                        circle.setAttribute('cx', point.x);
                        circle.setAttribute('cy', point.y);
                        circle.setAttribute('r', '3');
                        circle.setAttribute('fill', 'rgb(34,197,94)');
                        circle.setAttribute('stroke', 'white');
                        circle.setAttribute('stroke-width', '1');
                        
                        // æ·»åŠ hoveræ•ˆæœ
                        circle.addEventListener('mouseover', function() {
                            circle.setAttribute('r', '5');
                            // å¯ä»¥æ·»åŠ tooltipæ˜¾ç¤ºå…·ä½“æ•°å€¼
                        });
                        circle.addEventListener('mouseout', function() {
                            circle.setAttribute('r', '3');
                        });
                        
                        chartSvg.appendChild(circle);
                    });
                    
                    // æ›´æ–°è½®æ¬¡æ˜¾ç¤º
                    const currentRound = (node.trainingRounds || 0) - rounds + 1;
                    const roundText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.project.round') : 'è½®æ¬¡';
                document.getElementById('modalRoundStart').textContent = `${roundText} ${Math.max(1, currentRound)}`;
                document.getElementById('modalRoundEnd').textContent = `${roundText} ${node.trainingRounds || rounds}`;
                    const historyAccuracyText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.project.historyAccuracy') : 'å†å²å‡†ç¡®ç‡';
                     document.getElementById('modalAccuracyHistory').textContent = 
                         `${historyAccuracyText}: ${accuracyData.map(acc => acc.toFixed(2)).join('% â†’ ')}%`;
                } else {
                    // å¦‚æœæ²¡æœ‰å†å²æ•°æ®ï¼Œæ˜¾ç¤ºå ä½å†…å®¹
                    const chartSvg = document.getElementById('modalAccuracyChart');
                    const noDataSvgText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.project.noHistoryData') : 'æš‚æ— å†å²æ•°æ®';
                     chartSvg.innerHTML = `<text x="50%" y="50%" text-anchor="middle" fill="#9CA3AF" font-size="12">${noDataSvgText}</text>`;
                    const roundText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.project.round') : 'è½®æ¬¡';
                const currentText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.project.current') : 'å½“å‰';
                const noDataText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.project.noHistoryData') : 'æš‚æ— å†å²æ•°æ®';
                
                document.getElementById('modalRoundStart').textContent = roundText;
                document.getElementById('modalRoundEnd').textContent = currentText;
                document.getElementById('modalAccuracyHistory').textContent = noDataText;
                }
            } else {
                trainingStatsDiv.style.display = 'none';
            }
            
            // æ ¹æ®èŠ‚ç‚¹çŠ¶æ€æ§åˆ¶æŒ‰é’®æ˜¾ç¤º
            const stopBtn = document.getElementById('stopTrainingBtn');
            const restartBtn = document.getElementById('restartTrainingBtn');
            const exportBtn = document.getElementById('exportResultBtn');
            
            if (node.status === 'completed') {
                stopBtn.style.display = 'none';
                const retrainText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.project.retrain') : 'é‡æ–°è®­ç»ƒ';
                restartBtn.textContent = retrainText;
                exportBtn.style.display = 'inline-block';
            } else if (node.status === 'training') {
                stopBtn.style.display = 'inline-block';
                const restartTrainingText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.project.restartTraining') : 'é‡å¯è®­ç»ƒ';
                restartBtn.textContent = restartTrainingText;
                restartBtn.style.display = 'inline-block';
                exportBtn.style.display = 'none';
            } else {
                stopBtn.style.display = 'none';
                const startTrainingText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.training.local.startTraining') : 'å¼€å§‹è®­ç»ƒ';
                restartBtn.textContent = startTrainingText;
                restartBtn.style.display = 'inline-block';
                exportBtn.style.display = 'none';
            }
            
            // æ˜¾ç¤ºæ¨¡æ€æ¡†
            modal.classList.add('show');
        }

        // å…³é—­æ¨¡æ€å¡ç‰‡
        function closeNodeModal() {
            const modal = document.getElementById('nodeModal');
            modal.classList.remove('show');
        }

        // è·å–çŠ¶æ€æ–‡æœ¬
        function getStatusText(status) {
            const statusMap = {
                'training': 'æ­£åœ¨è®­ç»ƒ',
                'completed': 'è®­ç»ƒå®Œæˆ',
                'idle': 'ç©ºé—²å¾…å‘½',
                'error': 'é”™è¯¯çŠ¶æ€'
            };
            return statusMap[status] || 'æœªçŸ¥çŠ¶æ€';
        }

        // åœæ­¢è®­ç»ƒåŠŸèƒ½
        function stopTraining() {
            alert('åœæ­¢è®­ç»ƒåŠŸèƒ½æš‚æœªå®ç°');
        }

        // é‡å¯è®­ç»ƒåŠŸèƒ½
        function restartTraining() {
            alert('é‡å¯è®­ç»ƒåŠŸèƒ½æš‚æœªå®ç°');
        }

        // å¯¼å‡ºè®­ç»ƒç»“æœåŠŸèƒ½
        function exportTrainingResult() {
            if (!selectedNode) {
                alert('æœªé€‰æ‹©èŠ‚ç‚¹');
                return;
            }
            
            const result = {
                nodeInfo: {
                    name: selectedNode.name,
                    url: selectedNode.url,
                    status: selectedNode.status
                },
                trainingResults: {
                    totalRounds: selectedNode.trainingRounds || 0,
                    finalAccuracy: selectedNode.accuracy ? selectedNode.accuracy.toFixed(2) : 'N/A',
                    finalLoss: selectedNode.loss ? selectedNode.loss.toFixed(2) : 'N/A',
                    progress: selectedNode.progress
                },
                historyData: selectedNode.stats || {}
            };
            
            // åˆ›å»ºJSONæ–‡ä»¶å¹¶ä¸‹è½½
            const dataStr = JSON.stringify(result, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `${selectedNode.name}_è®­ç»ƒç»“æœ_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            alert(`${selectedNode.name} çš„è®­ç»ƒç»“æœå·²å¯¼å‡ºï¼\n\nåŒ…å«ä¿¡æ¯:\n- èŠ‚ç‚¹åŸºç¡€ä¿¡æ¯\n- æœ€ç»ˆè®­ç»ƒç»“æœ\n- å†å²æ•°æ®è®°å½•`);
        }

        // ========== é‚€è¯·ç”¨æˆ·æ¨¡æ€å¡ç‰‡åŠŸèƒ½ ==========
        
        function showInviteUserModal() {
            const modal = document.getElementById('inviteUserModal');
            modal.classList.add('show');
        }
        
        function closeInviteUserModal() {
            const modal = document.getElementById('inviteUserModal');
            modal.classList.remove('show');
            // æ¸…ç©ºè¡¨å•
            clearInviteForm();
        }
        
        // é‚®ç®±åˆ—è¡¨ç®¡ç†
        let inviteEmailList = [];
        
        function addEmailToList() {
            const emailInput = document.getElementById('inviteEmail');
            const email = emailInput.value.trim();
            
            if (!email) {
                alert('è¯·è¾“å…¥é‚®ç®±åœ°å€');
                return;
            }
            
            // ç®€å•çš„é‚®ç®±éªŒè¯
            if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€');
                return;
            }
            
            // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨
            if (inviteEmailList.includes(email)) {
                alert('è¯¥é‚®ç®±å·²åœ¨åˆ—è¡¨ä¸­');
                return;
            }
            
            inviteEmailList.push(email);
            updateInviteEmailList();
            emailInput.value = '';
        }
        
        function removeEmailFromList(email) {
            inviteEmailList = inviteEmailList.filter(e => e !== email);
            updateInviteEmailList();
        }
        
        function updateInviteEmailList() {
            const listDiv = document.getElementById('inviteEmailList');
            
            if (inviteEmailList.length === 0) {
                listDiv.innerHTML = '<div class="text-gray-500 text-sm">æš‚æ— å¾…é‚€è¯·ç”¨æˆ·</div>';
                return;
            }
            
            listDiv.innerHTML = inviteEmailList.map(email => `
                <div class="flex items-center justify-between bg-blue-50 px-3 py-2 rounded-lg">
                    <span class="font-mono text-sm">${email}</span>
                    <button onclick="removeEmailFromList('${email}')" class="text-red-500 hover:text-red-700 ml-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            `).join('');
        }
        
        function sendInvitations() {
            if (inviteEmailList.length === 0) {
                alert('è¯·è‡³å°‘æ·»åŠ ä¸€ä¸ªé‚®ç®±åœ°å€');
                return;
            }
            
            const role = document.querySelector('input[name="userRole"]:checked').value;
            const message = document.getElementById('inviteMessage').value;
            
            // æ¨¡æ‹Ÿå‘é€é‚€è¯·
            alert(`æ­£åœ¨å‘ ${inviteEmailList.length} ä¸ªç”¨æˆ·å‘é€é‚€è¯·...\n\nè§’è‰²: ${role === 'participant' ? 'å‚ä¸è€…' : 'è§‚å¯Ÿè€…'}\né‚®ç®±åˆ—è¡¨: ${inviteEmailList.join(', ')}`);
            
            // å‘é€æˆåŠŸåå…³é—­æ¨¡æ€æ¡†
            setTimeout(() => {
                closeInviteUserModal();
                alert('é‚€è¯·å·²æˆåŠŸå‘é€ï¼');
            }, 1000);
        }
        
        function clearInviteForm() {
            inviteEmailList = [];
            updateInviteEmailList();
            document.getElementById('inviteEmail').value = '';
            document.getElementById('inviteMessage').value = 'æ‚¨å¥½ï¼Œæˆ‘é‚€è¯·æ‚¨å‚ä¸æˆ‘ä»¬çš„EdgeAIé¡¹ç›®ã€‚æœŸå¾…ä¸æ‚¨åˆä½œï¼';
            document.querySelector('input[name="userRole"][value="participant"]').checked = true;
        }

        // ========== æ·»åŠ èŠ‚ç‚¹æ¨¡æ€å¡ç‰‡åŠŸèƒ½ ==========
        
        function showAddNodeModal() {
            const modal = document.getElementById('addNodeModal');
            modal.classList.add('show');
        }
        
        function closeAddNodeModal() {
            const modal = document.getElementById('addNodeModal');
            modal.classList.remove('show');
            // æ¸…ç©ºè¡¨å•
            clearAddNodeForm();
        }
        
        function testNodeConnection() {
            const address = document.getElementById('nodeAddress').value.trim();
            
            if (!address) {
                alert('è¯·è¾“å…¥èŠ‚ç‚¹åœ°å€');
                return;
            }
            
            // æ¨¡æ‹Ÿè¿æ¥æµ‹è¯•
            alert('æ­£åœ¨æµ‹è¯•è¿æ¥...');
            
            setTimeout(() => {
                const success = Math.random() > 0.3; // 70%æˆåŠŸç‡
                if (success) {
                    alert('è¿æ¥æµ‹è¯•æˆåŠŸï¼\n\nèŠ‚ç‚¹ä¿¡æ¯:\n- å“åº”æ—¶é—´: 25ms\n- çŠ¶æ€: åœ¨çº¿\n- å¯ç”¨èµ„æº: å……è¶³');
                } else {
                    alert('è¿æ¥æµ‹è¯•å¤±è´¥ï¼\n\nå¯èƒ½åŸå› :\n- èŠ‚ç‚¹åœ°å€ä¸æ­£ç¡®\n- èŠ‚ç‚¹æœªå¯åŠ¨\n- ç½‘ç»œè¿æ¥é—®é¢˜');
                }
            }, 1500);
        }
        
        function addNewNode() {
            const name = document.getElementById('nodeName').value.trim();
            const address = document.getElementById('nodeAddress').value.trim();
            const type = document.querySelector('input[name="nodeType"]:checked').value;
            const controlNode = document.getElementById('connectToControl').value;
            
            if (!name || !address) {
                alert('è¯·å¡«å†™èŠ‚ç‚¹åç§°å’Œåœ°å€');
                return;
            }
            
            // æ¨¡æ‹Ÿæ·»åŠ èŠ‚ç‚¹
            const nodeInfo = {
                name,
                address,
                type: type === 'edge' ? 'è¾¹ç¼˜èŠ‚ç‚¹' : type === 'control' ? 'æ§åˆ¶èŠ‚ç‚¹' : 'è§‚å¯ŸèŠ‚ç‚¹',
                controlNode: controlNode || 'æ— ',
                cpuCores: document.getElementById('nodeCpuCores').value || 'æœªæŒ‡å®š',
                memory: document.getElementById('nodeMemory').value || 'æœªæŒ‡å®š',
                gpu: document.getElementById('nodeGpuType').value || 'æ— ',
                ssl: document.getElementById('enableSSL').checked,
                auth: document.getElementById('enableAuth').checked,
                monitoring: document.getElementById('enableMonitoring').checked
            };
            
            alert(`æ­£åœ¨æ·»åŠ èŠ‚ç‚¹...\n\nèŠ‚ç‚¹ä¿¡æ¯:\n- åç§°: ${nodeInfo.name}\n- åœ°å€: ${nodeInfo.address}\n- ç±»å‹: ${nodeInfo.type}\n- è¿æ¥åˆ°: ${nodeInfo.controlNode}`);
            
            // æ·»åŠ æˆåŠŸåå…³é—­æ¨¡æ€æ¡†
            setTimeout(() => {
                closeAddNodeModal();
                alert('èŠ‚ç‚¹æ·»åŠ æˆåŠŸï¼');
                // è¿™é‡Œå¯ä»¥æ·»åŠ å®é™…çš„èŠ‚ç‚¹æ·»åŠ é€»è¾‘ï¼Œæ›´æ–°ç½‘ç»œæ•°æ®
            }, 1500);
        }
        
        function clearAddNodeForm() {
            document.getElementById('nodeName').value = '';
            document.getElementById('nodeAddress').value = '';
            document.getElementById('connectToControl').value = '';
            document.getElementById('nodeCpuCores').value = '';
            document.getElementById('nodeMemory').value = '';
            document.getElementById('nodeGpuType').value = '';
            document.querySelector('input[name="nodeType"][value="edge"]').checked = true;
            document.getElementById('enableSSL').checked = true;
            document.getElementById('enableAuth').checked = true;
            document.getElementById('enableMonitoring').checked = true;
        }
        
        // æ˜¾ç¤ºå…¶ä»–èŠ‚ç‚¹çš„åŸºæœ¬ä¿¡æ¯ï¼ˆP2PAIç‰¹æ€§ï¼‰
        function showBasicNodeInfo(node) {
            const title = node.status === 'online' ? `${getTranslatedNodeName(node.name)} - ${window.i18nManager?.getCurrentLanguage() === 'en' ? 'Online' : 'åœ¨çº¿'}` : `${getTranslatedNodeName(node.name)} - ${window.i18nManager?.getCurrentLanguage() === 'en' ? 'Offline' : 'ç¦»çº¿'}`;
            const statusColor = node.status === 'online' ? 'text-green-600' : 'text-gray-500';
            const statusText = node.status === 'online' ? 'åœ¨çº¿' : 'ç¦»çº¿';
            const lastSeen = node.heartbeat || 'æœªçŸ¥';
            
            const content = `
                <div class="detail-section">
                    <div class="detail-header">
                        <h4 class="detail-title">${getTranslatedNodeName(node.name)}</h4>
                        <span class="detail-badge ${node.status === 'online' ? 'success' : 'info'}">${statusText}</span>
                    </div>
                    
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4">
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <svg class="w-5 h-5 text-yellow-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
                                </svg>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm text-yellow-700">
                                    <strong>éšç§ä¿æŠ¤ï¼š</strong>æ ¹æ®P2PAIåè®®ï¼Œæ‚¨åªèƒ½æŸ¥çœ‹å…¶ä»–å‚ä¸æ–¹çš„åŸºæœ¬è¿æ¥çŠ¶æ€ï¼Œæ— æ³•è·å–è¯¦ç»†çš„è®­ç»ƒä¿¡æ¯ã€‚
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="detail-grid">
                        <div class="detail-item">
                            <div class="detail-label">å‚ä¸æ–¹åç§°</div>
                            <div class="detail-value">${getTranslatedNodeName(node.name)}</div>
                            <div class="detail-meta">å¤šæ–¹è®¡ç®—å‚ä¸èŠ‚ç‚¹</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">è¿æ¥çŠ¶æ€</div>
                            <div class="detail-value ${statusColor}">${statusText}</div>
                            <div class="detail-meta">æœ€åå¿ƒè·³: ${lastSeen}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">ç½‘ç»œåœ°å€</div>
                            <div class="detail-value font-mono">${node.url || 'ä¸å¯è§'}</div>
                            <div class="detail-meta">ç«¯ç‚¹è®¿é—®åœ°å€</div>
                        </div>
                    </div>
                    
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <h5 class="text-sm font-semibold text-blue-800 mb-2">å¯è·å–ä¿¡æ¯</h5>
                        <ul class="text-sm text-blue-700 space-y-1">
                            <li>â€¢ èŠ‚ç‚¹åœ¨çº¿/ç¦»çº¿çŠ¶æ€</li>
                            <li>â€¢ ç½‘ç»œè¿æ¥å¯ç”¨æ€§</li>
                            <li>â€¢ åŸºæœ¬é€šä¿¡å»¶è¿Ÿ</li>
                        </ul>
                        <h5 class="text-sm font-semibold text-blue-800 mb-2 mt-3">éšç§ä¿æŠ¤ä¿¡æ¯</h5>
                        <ul class="text-sm text-blue-700 space-y-1">
                            <li>â€¢ è®­ç»ƒè¿›åº¦å’Œå‡†ç¡®ç‡</li>
                            <li>â€¢ ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ</li>
                            <li>â€¢ æ•°æ®é›†å’Œæ¨¡å‹è¯¦æƒ…</li>
                        </ul>
                    </div>
                </div>
            `;
            
            showModal('å‚ä¸æ–¹åŸºæœ¬ä¿¡æ¯', content);
        }

        // é€šç”¨æ¨¡æ€æ¡†æ˜¾ç¤ºå‡½æ•°
        function showModal(title, content) {
            // åˆ›å»ºä¸´æ—¶æ¨¡æ€æ¡†å…ƒç´ 
            const modalId = 'tempModal';
            let existingModal = document.getElementById(modalId);
            
            // å¦‚æœå·²å­˜åœ¨ï¼Œå…ˆç§»é™¤
            if (existingModal) {
                existingModal.remove();
            }
            
            const modalHTML = `
                <div id="${modalId}" class="node-modal show">
                    <div class="node-modal-card" style="max-width: 600px;">
                        <div class="p-6">
                            <div class="flex justify-between items-center mb-6">
                                <h2 class="text-2xl font-bold text-gray-900">${title}</h2>
                                <button onclick="closeTempModal()" class="text-gray-400 hover:text-gray-600 transition-colors">
                                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                    </svg>
                                </button>
                            </div>
                            <div class="modal-content">${content}</div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            
            // æ·»åŠ ç‚¹å‡»å¤–éƒ¨å…³é—­åŠŸèƒ½
            const modal = document.getElementById(modalId);
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    closeTempModal();
                }
            });
            
            // æ·»åŠ ESCé”®å…³é—­åŠŸèƒ½
            const escHandler = function(e) {
                if (e.key === 'Escape') {
                    closeTempModal();
                    document.removeEventListener('keydown', escHandler);
                }
            };
            document.addEventListener('keydown', escHandler);
        }
        
        // å…³é—­ä¸´æ—¶æ¨¡æ€æ¡†
        function closeTempModal() {
            const modal = document.getElementById('tempModal');
            if (modal) {
                modal.remove();
            }
        }

        // æ˜¾ç¤ºèŠ‚ç‚¹è¯¦æƒ…
        function showNodeDetails(node, type) {
            selectedNode = node;
            const detailsPanel = document.getElementById('nodeDetails');
            const nodeTitle = document.getElementById('nodeTitle');
            const nodeInfo = document.getElementById('nodeInfo');
            
            const detailsText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.project.details') : 'è¯¦æƒ…';
                nodeTitle.textContent = `${getTranslatedNodeName(node.name)} - ${detailsText}`;
            
            if (type === 'control') {
                nodeInfo.innerHTML = `
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">èŠ‚ç‚¹ç±»å‹</span>
                            <span class="font-semibold">æ§åˆ¶èŠ‚ç‚¹</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">è§’è‰²</span>
                            <span class="font-semibold">${node.type === 'master' ? 'ä¸»æ§åˆ¶å™¨' : node.type === 'participant' ? 'å‚ä¸è€…' : 'è§‚å¯Ÿè€…'}</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">çŠ¶æ€</span>
                            <span class="font-semibold text-green-600">åœ¨çº¿</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">è´Ÿè´£ç”¨æˆ·</span>
                            <span class="font-semibold">${node.user}</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">IPåœ°å€</span>
                            <span class="font-semibold text-xs">${node.ip}</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">è¿æ¥èŠ‚ç‚¹</span>
                            <span class="font-semibold">${networkData.edgeNodes.filter(n => n.status !== 'error').length}${window.i18nManager?.getCurrentLanguage() === 'en' ? '' : 'ä¸ª'}</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">è¿è¡Œæ—¶é—´</span>
                            <span class="font-semibold">15å¤©</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">ç‰ˆæœ¬</span>
                            <span class="font-semibold">v2.1.0</span>
                        </div>
                    </div>
                `;
            } else {
                const statusColor = {
                    training: 'text-blue-600',
                    completed: 'text-green-600',
                    idle: 'text-gray-600',
                    error: 'text-red-600'
                }[node.status];
                
                const statusText = {
                    training: 'è®­ç»ƒä¸­',
                    completed: 'å·²å®Œæˆ',
                    idle: 'ç©ºé—²',
                    error: 'é”™è¯¯'
                }[node.status];
                
                nodeInfo.innerHTML = `
                    <div class="space-y-4">
                        <!-- åŸºç¡€ä¿¡æ¯å¡ç‰‡ -->
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h5 class="font-semibold mb-3 text-blue-600">åŸºç¡€ä¿¡æ¯</h5>
                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <span class="text-xs text-gray-600">èŠ‚ç‚¹ç±»å‹</span>
                                    <div class="font-semibold">è¾¹ç¼˜èŠ‚ç‚¹</div>
                                </div>
                                <div>
                                    <span class="text-xs text-gray-600">çŠ¶æ€</span>
                                    <div class="font-semibold ${statusColor}">${statusText}</div>
                                </div>
                                <div>
                                    <span class="text-xs text-gray-600">è®­ç»ƒè¿›åº¦</span>
                                    <div class="font-semibold text-blue-600">${node.progress}%</div>
                                </div>
                                <div>
                                    <span class="text-xs text-gray-600">æœ€åå¿ƒè·³</span>
                                    <div class="font-semibold">${node.heartbeat}</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ç½‘ç»œä¿¡æ¯å¡ç‰‡ -->
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h5 class="font-semibold mb-3 text-purple-600">ç½‘ç»œä¿¡æ¯</h5>
                            <div class="space-y-2">
                                <div>
                                    <span class="text-xs text-gray-600">èŠ‚ç‚¹åœ°å€</span>
                                    <div class="font-mono text-sm text-blue-600">${node.url || 'http://192.168.1.xxx:8080'}</div>
                                </div>
                                <div>
                                    <span class="text-xs text-gray-600">è¿æ¥çš„æ§åˆ¶èŠ‚ç‚¹</span>
                                    <div class="space-y-1">
                                        ${(node.connectedTo || ['http://192.168.1.100:8080']).map(url => 
                                            `<div class="font-mono text-sm text-green-600">${url}</div>`
                                        ).join('')}
                                    </div>
                                </div>
                                <div>
                                    <span class="text-xs text-gray-600">ç½‘ç»œé€Ÿåº¦</span>
                                    <div class="font-semibold">72Mbps</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- è®­ç»ƒç»Ÿè®¡å¡ç‰‡ -->
                        ${node.status === 'training' && node.trainingRounds ? `
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h5 class="font-semibold mb-3 text-orange-600">è®­ç»ƒç»Ÿè®¡</h5>
                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <span class="text-xs text-gray-600">è®­ç»ƒè½®æ•°</span>
                                    <div class="font-bold text-lg">${node.trainingRounds || 0}</div>
                                </div>
                                <div>
                                    <span class="text-xs text-gray-600">å½“å‰å‡†ç¡®ç‡</span>
                                    <div class="font-bold text-lg text-green-600">${(node.accuracy || 0).toFixed(2)}%</div>
                                </div>
                                <div>
                                    <span class="text-xs text-gray-600">æŸå¤±å€¼</span>
                                    <div class="font-bold text-lg text-red-600">${(node.loss || 0).toFixed(2)}</div>
                                </div>
                                <div>
                                    <span class="text-xs text-gray-600">å­¦ä¹ ç‡</span>
                                    <div class="font-bold text-lg">0.001</div>
                                </div>
                            </div>
                        </div>
                        ` : ''}
                        
                        <!-- èµ„æºä½¿ç”¨å¡ç‰‡ -->
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h5 class="font-semibold mb-3 text-red-600">èµ„æºä½¿ç”¨</h5>
                            <div class="space-y-3">
                                <div>
                                    <div class="flex justify-between text-sm">
                                        <span>CPUä½¿ç”¨ç‡</span>
                                        <span class="font-semibold">${node.cpu.toFixed(2)}%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2 mt-1">
                                        <div class="bg-blue-600 h-2 rounded-full" style="width: ${node.cpu}%"></div>
                                    </div>
                                </div>
                                <div>
                                    <div class="flex justify-between text-sm">
                                        <span>GPUä½¿ç”¨ç‡</span>
                                        <span class="font-semibold">${node.gpu.toFixed(2)}%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2 mt-1">
                                        <div class="bg-green-600 h-2 rounded-full" style="width: ${node.gpu}%"></div>
                                    </div>
                                </div>
                                <div>
                                    <div class="flex justify-between text-sm">
                                        <span>å†…å­˜ä½¿ç”¨</span>
                                        <span class="font-semibold">${node.memory}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- å†å²è¶‹åŠ¿å¡ç‰‡ -->
                        ${node.stats ? `
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h5 class="font-semibold mb-3 text-indigo-600">è¶‹åŠ¿åˆ†æ</h5>
                            <div class="space-y-2">
                                <div>
                                    <span class="text-xs text-gray-600">å‡†ç¡®ç‡è¶‹åŠ¿</span>
                                    <div class="flex items-center space-x-1 mt-1">
                                        ${node.stats.accuracyHistory.map(acc => 
                                            `<div class="flex-1 bg-green-200 rounded h-3" style="height: ${(acc/100) * 20 + 5}px"></div>`
                                        ).join('')}
                                    </div>
                                    <div class="text-xs text-gray-500 mt-1">æœ€è¿‘4è½®: ${node.stats.accuracyHistory.map(acc => acc.toFixed(2)).join(' â†’ ')}%</div>
                                </div>
                            </div>
                        </div>
                        ` : ''}
                    </div>
                `;
            }
            
            detailsPanel.classList.add('show');
        }
        
        // å…³é—­èŠ‚ç‚¹è¯¦æƒ…
        function closeNodeDetails() {
            const detailsPanel = document.getElementById('nodeDetails');
            if (detailsPanel) {
                detailsPanel.classList.remove('show');
                selectedNode = null;
            }
        }
        
        // æ·»åŠ ç‚¹å‡»å¤–éƒ¨å…³é—­é¢æ¿çš„åŠŸèƒ½
        document.addEventListener('click', function(e) {
            // å¤„ç†æŸ¥çœ‹è¯¦æƒ…æŒ‰é’®ç‚¹å‡»
            if (e.target.classList.contains('node-details-btn')) {
                e.preventDefault();
                e.stopPropagation();
                const nodeId = e.target.getAttribute('data-node-id');
                
                // æŸ¥æ‰¾èŠ‚ç‚¹æ•°æ®
                const node = networkData.allEdgeNodes.find(n => n.id === nodeId);
                if (node) {
                    // P2PAIç‰¹æ€§ï¼šæ ¹æ®èŠ‚ç‚¹ç±»å‹æ˜¾ç¤ºä¸åŒä¿¡æ¯
                    if (node.isOwnNode) {
                        // è‡ªå·±çš„èŠ‚ç‚¹ - æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
                        showNodeDetails(node, 'edge');
                    } else {
                        // å…¶ä»–å‚ä¸æ–¹èŠ‚ç‚¹ - æ˜¾ç¤ºåŸºæœ¬ä¿¡æ¯
                        showBasicNodeInfo(node);
                    }
                }
                return;
            }
            
            // å¤„ç†æ¨¡æ€æ¡†å¤–éƒ¨ç‚¹å‡»å…³é—­
            const nodeModal = document.getElementById('nodeModal');
            const inviteModal = document.getElementById('inviteUserModal');
            const addNodeModal = document.getElementById('addNodeModal');
            
            if (nodeModal && nodeModal.classList.contains('show')) {
                // å¦‚æœç‚¹å‡»çš„æ˜¯æ¨¡æ€æ¡†èƒŒæ™¯ï¼Œå…³é—­æ¨¡æ€æ¡†
                if (e.target === nodeModal) {
                    closeNodeModal();
                }
            }
            
            if (inviteModal && inviteModal.classList.contains('show')) {
                if (e.target === inviteModal) {
                    closeInviteUserModal();
                }
            }
            
            if (addNodeModal && addNodeModal.classList.contains('show')) {
                if (e.target === addNodeModal) {
                    closeAddNodeModal();
                }
            }
            
            const nodeDetails = document.getElementById('nodeDetails');
            const controlPanel = document.querySelector('.control-panel');
            
            if (nodeDetails && nodeDetails.classList.contains('show')) {
                // å¦‚æœç‚¹å‡»çš„ä¸æ˜¯èŠ‚ç‚¹è¯¦æƒ…é¢æ¿å†…éƒ¨ã€æ§åˆ¶é¢æ¿å†…éƒ¨ã€æˆ–SVGèŠ‚ç‚¹
                if (!nodeDetails.contains(e.target) && 
                    !controlPanel.contains(e.target) && 
                    !e.target.closest('.edge-node') && 
                    !e.target.closest('.control-node')) {
                    closeNodeDetails();
                }
            }
        });
        
        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        function updateStats() {
            // P2PAIç‰¹æ€§ï¼šåªæ˜¾ç¤ºè‡ªå·±èŠ‚ç‚¹çš„è¿›åº¦å’Œåœ¨çº¿å‚ä¸æ–¹æ•°é‡
            const onlineParticipants = networkData.allEdgeNodes.filter(n => n.status === 'online').length;
            const myNode = networkData.allEdgeNodes.find(n => n.isOwnNode);
            const myProgress = myNode ? myNode.progress || 0 : 0;
            
            // æ›´æ–°æ§åˆ¶é¢æ¿å®æ—¶çŠ¶æ€
            document.getElementById('onlineNodes').textContent = onlineParticipants;
            document.getElementById('trainingNodes').textContent = `${myProgress}%`;
            const encryptedText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.project.encrypted') : 'åŠ å¯†';
                document.getElementById('dataTransfer').textContent = encryptedText;
            
            // æ›´æ–°æ¦‚è§ˆå¡ç‰‡
            document.getElementById('totalNodesCount').textContent = networkData.allEdgeNodes.length + networkData.controlNodes.length;
            document.getElementById('avgProgress').textContent = `${myProgress}%`;
            // æ›´æ–°è®­ç»ƒè¿›åº¦æ¡
            const myProgressBar = document.getElementById('myProgressBar');
            if (myProgressBar) {
                myProgressBar.style.width = `${myProgress}%`;
            }
            document.getElementById('networkLatency').textContent = `${Math.floor(Math.random() * 20 + 15)}ms`;
            const enabledText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.project.enabled') : 'å¯ç”¨';
                document.getElementById('systemHealth').textContent = enabledText;
            
            // æ›´æ–°èŠ‚ç‚¹è®¡æ•°
            document.getElementById('controlNodeCount').textContent = networkData.controlNodes.length;
            document.getElementById('edgeNodeCount').textContent = networkData.allEdgeNodes.length;
            document.getElementById('totalNodeCount').textContent = networkData.controlNodes.length + networkData.allEdgeNodes.length;
            
            // æ›´æ–°é¡¹ç›®å¤´éƒ¨çš„å¿«é€Ÿç»Ÿè®¡
            const totalNodes = networkData.controlNodes.length + networkData.allEdgeNodes.length;
            const onlineNodes = onlineParticipants;
            
            document.getElementById('quickNodeCount').textContent = totalNodes;
            document.getElementById('quickOnlineCount').textContent = onlineNodes;
            
            // æ£€æŸ¥è®­ç»ƒå®ŒæˆçŠ¶æ€
            checkTrainingComplete();
        }
        
        // æ£€æŸ¥è®­ç»ƒå®ŒæˆçŠ¶æ€
        function checkTrainingComplete() {
            const allNodes = networkData.allEdgeNodes;
            const trainingNodes = allNodes.filter(n => n.status === 'training' || n.status === 'idle');
            const completedNodes = allNodes.filter(n => n.status === 'completed');
            const totalActiveNodes = allNodes.filter(n => n.status !== 'error');
            
            // å¦‚æœæ‰€æœ‰æ´»è·ƒèŠ‚ç‚¹éƒ½å·²å®Œæˆè®­ç»ƒï¼Œæ˜¾ç¤ºå®ŒæˆçŠ¶æ€
            if (trainingNodes.length === 0 && completedNodes.length > 0) {
                showTrainingComplete(completedNodes.length);
            } else {
                hideTrainingComplete();
            }
        }
        
        // æ˜¾ç¤ºè®­ç»ƒå®ŒæˆçŠ¶æ€
        function showTrainingComplete(completedCount) {
            const completeOverlay = document.getElementById('trainingComplete');
            const statsText = document.getElementById('trainingCompleteStats');
            
            if (completeOverlay && statsText) {
                const completedTrainingText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.project.completedTraining') : 'å…±å®Œæˆ';
                const nodesTrainingText = window.i18nManager ? window.i18nManager.getTranslation('p2pai.dashboard.project.nodesTraining') : 'ä¸ªèŠ‚ç‚¹çš„è®­ç»ƒ';
                statsText.textContent = `${completedTrainingText} ${completedCount} ${nodesTrainingText}`;
                completeOverlay.style.display = 'block';
            }
        }
        
        // éšè—è®­ç»ƒå®ŒæˆçŠ¶æ€
        function hideTrainingComplete() {
            const completeOverlay = document.getElementById('trainingComplete');
            if (completeOverlay) {
                completeOverlay.style.display = 'none';
            }
        }
        
        // å¡«å……èŠ‚ç‚¹è¡¨æ ¼
        function fillNodeTables() {
            fillControlNodesTable();
            fillEdgeNodesTable();
        }
        
        // å¡«å……æ§åˆ¶èŠ‚ç‚¹è¡¨æ ¼
        function fillControlNodesTable() {
            const tableBody = document.getElementById('controlNodesTable');
            tableBody.innerHTML = '';
            
            networkData.controlNodes.forEach(node => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50 cursor-pointer';
                row.onclick = () => showNodeDetails(node, 'control');
                
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="w-3 h-3 bg-green-500 rounded-full mr-3"></div>
                            <span class="text-sm font-medium text-gray-900">${getTranslatedNodeName(node.name)}</span>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="text-sm text-gray-900">${getTranslatedRoleType(node.type)}</span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                            ${getTranslatedStatus('åœ¨çº¿')}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${node.user}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 font-mono">${node.ip}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${networkData.edgeNodes.filter(n => n.status !== 'error').length}${window.i18nManager?.getCurrentLanguage() === 'en' ? '' : 'ä¸ª'}</td>
                `;
                
                tableBody.appendChild(row);
            });
        }
        
        // å¡«å……è¾¹ç¼˜èŠ‚ç‚¹è¡¨æ ¼
        function fillEdgeNodesTable() {
            const tableBody = document.getElementById('edgeNodesTable');
            tableBody.innerHTML = '';
            
            networkData.allEdgeNodes.forEach(node => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50';
                
                // P2PAIç‰¹æ€§ï¼šæ ¹æ®èŠ‚ç‚¹æ‰€æœ‰æƒæ˜¾ç¤ºä¸åŒä¿¡æ¯
                if (node.isOwnNode) {
                    // è‡ªå·±çš„èŠ‚ç‚¹ - æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
                    const statusColorMap = {
                        'training': 'bg-red-100 text-red-800',
                        'completed': 'bg-green-100 text-green-800',
                        'idle': 'bg-gray-100 text-gray-800',
                        'error': 'bg-red-100 text-red-800'
                    };
                    
                    const statusTextMap = {
                        'training': 'è®­ç»ƒä¸­',
                        'completed': 'å·²å®Œæˆ',
                        'idle': 'ç©ºé—²',
                        'error': 'é”™è¯¯'
                    };
                    
                    const statusColor = statusColorMap[node.status] || 'bg-gray-100 text-gray-800';
                    const statusText = getTranslatedStatus(statusTextMap[node.status] || 'æœªçŸ¥');
                    
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-red-500 rounded-full mr-3"></div>
                                <span class="text-sm font-medium text-gray-900">${getTranslatedNodeName(node.name)} <span class="text-xs text-red-600">(${window.i18nManager?.getCurrentLanguage() === 'en' ? 'My Node' : 'æˆ‘çš„èŠ‚ç‚¹'})</span></span>
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${statusColor}">
                                ${statusText}
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex items-center">
                                <div class="w-full bg-gray-200 rounded-full h-2 mr-2">
                                    <div class="bg-red-600 h-2 rounded-full" style="width: ${node.progress || 0}%"></div>
                                </div>
                                <span class="text-sm text-gray-900">${node.progress || 0}%</span>
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${node.cpu ? node.cpu.toFixed(2) + '%' : 'N/A'}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${node.memory || 'N/A'}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${node.gpu ? node.gpu.toFixed(2) + '%' : 'N/A'}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${getTranslatedHeartbeat(node.heartbeat)}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <button class="text-red-600 hover:text-red-900 px-3 py-2 rounded border border-red-300 hover:border-red-500 bg-transparent cursor-pointer transition-colors duration-200 node-details-btn" data-node-id="${node.id}">${window.i18nManager?.getCurrentLanguage() === 'en' ? 'View Details' : 'æŸ¥çœ‹è¯¦æƒ…'}</button>
                        </td>
                    `;
                } else {
                    // å…¶ä»–å‚ä¸æ–¹çš„èŠ‚ç‚¹ - åªæ˜¾ç¤ºåŸºæœ¬çŠ¶æ€
                    const statusColor = node.status === 'online' ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800';
                    const statusText = getTranslatedStatus(node.status === 'online' ? 'åœ¨çº¿' : 'ç¦»çº¿');
                    const dotColor = node.status === 'online' ? 'bg-green-500' : 'bg-gray-400';
                    
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex items-center">
                                <div class="w-3 h-3 ${dotColor} rounded-full mr-3"></div>
                                <span class="text-sm font-medium text-gray-900">${getTranslatedNodeName(node.name)}</span>
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${statusColor}">
                                ${statusText}
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-400">
                            <span class="italic">${window.i18nManager?.getCurrentLanguage() === 'en' ? 'Privacy Protected' : 'éšç§ä¿æŠ¤'}</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-400">-</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-400">-</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-400">-</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${getTranslatedHeartbeat(node.heartbeat)}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <button class="text-green-600 hover:text-green-900 px-3 py-2 rounded border border-green-300 hover:border-green-500 bg-transparent cursor-pointer transition-colors duration-200 node-details-btn" data-node-id="${node.id}">${window.i18nManager?.getCurrentLanguage() === 'en' ? 'Basic Info' : 'åŸºæœ¬ä¿¡æ¯'}</button>
                        </td>
                    `;
                }
                
                tableBody.appendChild(row);
            });
        }
        
        // å¯åŠ¨å®æ—¶æ›´æ–°
        function startRealTimeUpdates() {
            setInterval(() => {
                let hasCompletedNodes = false;
                
                // éšæœºå°†ç­‰å¾…ä¸­çš„èŠ‚ç‚¹å¼€å§‹è®­ç»ƒ
                const idleNodes = networkData.allEdgeNodes.filter(n => n.status === 'idle');
                if (idleNodes.length > 0 && Math.random() < 0.3) {
                    const randomIdleNode = idleNodes[Math.floor(Math.random() * idleNodes.length)];
                    randomIdleNode.status = 'training';
                    randomIdleNode.progress = Math.floor(Math.random() * 10); // å¼€å§‹è¿›åº¦
                    randomIdleNode.fadeIn = true; // æ ‡è®°èŠ‚ç‚¹éœ€è¦æ·¡å…¥
                }
                
                // éšæœºæ›´æ–°è®­ç»ƒè¿›åº¦
                networkData.allEdgeNodes.forEach(node => {
                    if (node.status === 'training' && node.progress < 100) {
                        node.progress = Math.min(100, node.progress + Math.floor(Math.random() * 3));
                        
                        // æ›´æ–°è®­ç»ƒç»Ÿè®¡æ•°æ®
                        if (node.trainingRounds) {
                            node.trainingRounds += Math.floor(Math.random() * 3 + 1);
                            
                            // æ›´æ–°å‡†ç¡®ç‡å’ŒæŸå¤±å€¼
                            if (Math.random() < 0.7) { // 70%æ¦‚ç‡æå‡å‡†ç¡®ç‡
                                node.accuracy = Math.min(99.9, node.accuracy + Math.random() * 0.3);
                                node.loss = Math.max(0.001, node.loss - Math.random() * 0.005);
                            }
                            
                            // æ›´æ–°èµ„æºä½¿ç”¨å†å²
                            if (node.stats) {
                                // CPUæ³¢åŠ¨
                                const cpuChange = (Math.random() - 0.5) * 10;
                                node.cpu = Math.round((Math.max(10, Math.min(100, node.cpu + cpuChange)) * 100)) / 100;
                                
                                // GPUæ³¢åŠ¨
                                const gpuChange = (Math.random() - 0.5) * 8;
                                node.gpu = Math.round((Math.max(0, Math.min(100, node.gpu + gpuChange)) * 100)) / 100;
                                
                                // æ›´æ–°å†å²è®°å½•ï¼ˆä¿æŒæœ€è¿‘4ä¸ªå€¼ï¼‰
                                node.stats.cpuHistory.push(node.cpu);
                                node.stats.gpuHistory.push(node.gpu);
                                node.stats.accuracyHistory.push(Math.round(node.accuracy * 10) / 10);
                                
                                if (node.stats.cpuHistory.length > 4) {
                                    node.stats.cpuHistory.shift();
                                    node.stats.gpuHistory.shift();
                                    node.stats.accuracyHistory.shift();
                                }
                            }
                        }
                        
                        if (node.progress >= 100) {
                            node.status = 'completed';
                            node.fadeOut = true; // æ ‡è®°èŠ‚ç‚¹éœ€è¦æ·¡å‡º
                            hasCompletedNodes = true;
                        }
                    }
                });
                
                // å¦‚æœæœ‰èŠ‚ç‚¹å®Œæˆè®­ç»ƒï¼Œå»¶è¿Ÿæ›´æ–°å¯è§†åŒ–èŠ‚ç‚¹ï¼ˆè®©æ·¡å‡ºåŠ¨ç”»å…ˆæ’­æ”¾ï¼‰
                if (hasCompletedNodes) {
                    // ç«‹å³é‡ç»˜ä»¥æ˜¾ç¤ºæ·¡å‡ºåŠ¨ç”»
                    drawNodes();
                    drawConnections();
                    
                    // 1ç§’åæ›´æ–°å¯è§†åŒ–èŠ‚ç‚¹åˆ—è¡¨ï¼ˆç§»é™¤å·²å®Œæˆçš„èŠ‚ç‚¹ï¼‰
                    setTimeout(() => {
                        updateVisualizedNodes();
                        drawNodes();
                        drawConnections();
                        updateStats();
                        fillNodeTables();
                    }, 1000);
                } else {
                    // æ­£å¸¸æ›´æ–°
                    updateVisualizedNodes();
                    drawNodes();
                    drawConnections();
                    updateStats();
                    fillNodeTables();
                }
                
                // è§¦å‘æ•°æ®ä¼ è¾“åŠ¨ç”»ï¼ˆé«˜é¢‘æµ‹è¯•ï¼š80%æ¦‚ç‡ï¼‰
                if (Math.random() < 0.8) {
                    triggerDataTransmissions();
                }
                
                // éšæœºæ•°æ®ä¼ è¾“é€Ÿåº¦
                const speeds = ['0.8MB/s', '1.2MB/s', '2.1MB/s', '1.5MB/s', '0.9MB/s'];
                document.getElementById('dataTransfer').textContent = speeds[Math.floor(Math.random() * speeds.length)];
                
                // éšæœºç½‘ç»œå»¶è¿Ÿï¼ˆå¦‚æœå…ƒç´ å­˜åœ¨ï¼‰
                const networkLatencyElement = document.getElementById('networkLatency');
                if (networkLatencyElement) {
                    networkLatencyElement.textContent = `${Math.floor(Math.random() * 20 + 15)}ms`;
                }
                
                // å¦‚æœæœ‰èŠ‚ç‚¹è¯¦æƒ…é¢æ¿æ‰“å¼€ï¼Œå®æ—¶æ›´æ–°å…¶å†…å®¹
                if (selectedNode && document.getElementById('nodeDetails').classList.contains('show')) {
                    const updatedNode = networkData.allEdgeNodes.find(n => n.id === selectedNode.id);
                    if (updatedNode) {
                        showNodeDetails(updatedNode, 'edge');
                    }
                }
            }, 3000);
        }
        
        // æ§åˆ¶é¢æ¿åŠŸèƒ½
        function inviteUser() {
            alert('é‚€è¯·ç”¨æˆ·åŠŸèƒ½å¼€å‘ä¸­...\n\nå°†æä¾›ï¼š\n- ç”¨æˆ·é‚€è¯·é“¾æ¥ç”Ÿæˆ\n- æƒé™è®¾ç½®\n- ç”¨æˆ·ç®¡ç†\n- åä½œæ§åˆ¶');
        }
        
        function addNode() {
            alert('æ·»åŠ èŠ‚ç‚¹åŠŸèƒ½å¼€å‘ä¸­...\n\nå°†æ”¯æŒï¼š\n- è‡ªåŠ¨å‘ç°è¾¹ç¼˜è®¾å¤‡\n- æ‰‹åŠ¨æ·»åŠ èŠ‚ç‚¹\n- èŠ‚ç‚¹é…ç½®\n- è¿æ¥æµ‹è¯•');
        }
        
        function startTraining() {
            alert('å¼€å§‹è®­ç»ƒåŠŸèƒ½å¼€å‘ä¸­...\n\nå°†åŒ…å«ï¼š\n- è®­ç»ƒå‚æ•°è®¾ç½®\n- æ•°æ®åˆ†å‘ç­–ç•¥\n- æ¨¡å‹åŒæ­¥æœºåˆ¶\n- è¿›åº¦ç›‘æ§');
        }
        
        // æµ‹è¯•åŠŸèƒ½ï¼šå®Œæˆæ‰€æœ‰è®­ç»ƒ
        function completeAllTraining() {
            networkData.allEdgeNodes.forEach(node => {
                if (node.status === 'training' || node.status === 'idle') {
                    node.status = 'completed';
                    node.progress = 100;
                }
            });
            
            // é‡æ–°ç»˜åˆ¶ç•Œé¢
            updateVisualizedNodes();
            drawNodes();
            drawConnections();
            updateStats();
            fillNodeTables();
            
            alert('æ‰€æœ‰èŠ‚ç‚¹è®­ç»ƒå·²å®Œæˆï¼');
        }
        
        function resetView() {
            // é‡ç½®å¯è§†åŒ–è§†å›¾
            initializeVisualization();
            closeNodeDetails();
            alert('è§†å›¾å·²é‡ç½®');
        }
        
        // è¾¹ç¼˜èŠ‚ç‚¹è¡¨æ ¼æ’åºåŠŸèƒ½
        function sortEdgeNodes(field) {
            // æ›´æ–°æ’åºæ–¹å‘
            if (currentSortField === field) {
                currentSortDirection = currentSortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                currentSortField = field;
                currentSortDirection = 'asc';
            }
            
            // æ¸…é™¤æ‰€æœ‰æ’åºæŒ‡ç¤ºå™¨
            const sortIndicators = ['sort-name', 'sort-status', 'sort-progress', 'sort-cpu', 'sort-memory', 'sort-gpu', 'sort-heartbeat'];
            sortIndicators.forEach(id => {
                const element = document.getElementById(id);
                if (element) element.textContent = 'â‡…';
            });
            
            // è®¾ç½®å½“å‰æ’åºæŒ‡ç¤ºå™¨
            const currentIndicator = document.getElementById(`sort-${field}`);
            if (currentIndicator) {
                currentIndicator.textContent = currentSortDirection === 'asc' ? 'â†‘' : 'â†“';
            }
            
            // æ‰§è¡Œæ’åº
            networkData.allEdgeNodes.sort((a, b) => {
                let valueA, valueB;
                
                switch(field) {
                    case 'name':
                        valueA = a.name.toLowerCase();
                        valueB = b.name.toLowerCase();
                        break;
                    case 'status':
                        // çŠ¶æ€æ’åºï¼štraining > idle > completed > error
                        const statusOrder = { 'training': 1, 'idle': 2, 'completed': 3, 'error': 4 };
                        valueA = statusOrder[a.status] || 5;
                        valueB = statusOrder[b.status] || 5;
                        break;
                    case 'progress':
                        valueA = a.progress || 0;
                        valueB = b.progress || 0;
                        break;
                    case 'cpu':
                        valueA = a.cpu || 0;
                        valueB = b.cpu || 0;
                        break;
                    case 'memory':
                        // è§£æå†…å­˜å€¼ï¼ˆå»é™¤GBåç¼€ï¼‰
                        valueA = parseFloat(a.memory.replace('GB', '')) || 0;
                        valueB = parseFloat(b.memory.replace('GB', '')) || 0;
                        break;
                    case 'gpu':
                        valueA = a.gpu || 0;
                        valueB = b.gpu || 0;
                        break;
                    case 'heartbeat':
                        // è§£æå¿ƒè·³æ—¶é—´ï¼ˆç®€åŒ–å¤„ç†ï¼‰
                        const parseHeartbeat = (heartbeat) => {
                            if (heartbeat.includes('ç§’å‰') || heartbeat.includes('s ago')) {
                                const match = heartbeat.match(/(\d+)/);
                                return match ? parseInt(match[1]) : 0;
                            } else if (heartbeat.includes('åˆ†é’Ÿå‰') || heartbeat.includes('m ago')) {
                                const match = heartbeat.match(/(\d+)/);
                                return match ? parseInt(match[1]) * 60 : 0;
                            } else if (heartbeat.includes('å°æ—¶å‰') || heartbeat.includes('h ago')) {
                                const match = heartbeat.match(/(\d+)/);
                                return match ? parseInt(match[1]) * 3600 : 0;
                            }
                            return 999; // å…¶ä»–æƒ…å†µæ’åœ¨æœ€å
                        };
                        valueA = parseHeartbeat(a.heartbeat);
                        valueB = parseHeartbeat(b.heartbeat);
                        break;
                    default:
                        valueA = a[field];
                        valueB = b[field];
                }
                
                if (typeof valueA === 'string' && typeof valueB === 'string') {
                    return currentSortDirection === 'asc' 
                        ? valueA.localeCompare(valueB)
                        : valueB.localeCompare(valueA);
                } else {
                    return currentSortDirection === 'asc' 
                        ? valueA - valueB 
                        : valueB - valueA;
                }
            });
            
            // é‡æ–°å¡«å……è¡¨æ ¼
            fillEdgeNodesTable();
        }
        
        // å¯¼èˆªåŠŸèƒ½
        function goBack() {
            window.location.href = '/p2pai/pages/client-dashboard.html';
        }
        
        // ç¿»è¯‘èŠ‚ç‚¹åç§°çš„å‡½æ•°
        function getTranslatedNodeName(originalName) {
            if (!window.i18nManager || window.i18nManager.getCurrentLanguage() === 'zh') {
                return originalName;
            }
            
            // ç¿»è¯‘æ˜ å°„
            const nodeNameMap = {
                'æˆ‘çš„èŠ‚ç‚¹': 'My Node',
                'ä¸»æ§èŠ‚ç‚¹1': 'Master Node 1',
                'ä¸»æ§èŠ‚ç‚¹2': 'Master Node 2',
                'å¤‡ç”¨æ§åˆ¶': 'Backup Control',
                'å‚ä¸æ–¹A': 'Participant A',
                'å‚ä¸æ–¹B': 'Participant B', 
                'å‚ä¸æ–¹C': 'Participant C',
                'å‚ä¸æ–¹D': 'Participant D',
                'å‚ä¸æ–¹E': 'Participant E',
                'å‚ä¸æ–¹F': 'Participant F',
                'å‚ä¸æ–¹G': 'Participant G',
                'å‚ä¸æ–¹H': 'Participant H',
                'å‚ä¸æ–¹I': 'Participant I',
                'å‚ä¸æ–¹J': 'Participant J',
                'å‚ä¸æ–¹K': 'Participant K',
                'å‚ä¸æ–¹L': 'Participant L',
                'å‚ä¸æ–¹M': 'Participant M',
                'å‚ä¸æ–¹N': 'Participant N',
                'å‚ä¸æ–¹O': 'Participant O',
                'å‚ä¸æ–¹P': 'Participant P',
                'å‚ä¸æ–¹Q': 'Participant Q',
                'å‚ä¸æ–¹R': 'Participant R',
                'å‚ä¸æ–¹S': 'Participant S'
            };
            
            return nodeNameMap[originalName] || originalName;
        }

        // ç¿»è¯‘è§’è‰²ç±»å‹çš„å‡½æ•°
        function getTranslatedRoleType(type) {
            if (!window.i18nManager || window.i18nManager.getCurrentLanguage() === 'zh') {
                const roleMap = {
                    'master': 'ä¸»æ§åˆ¶å™¨',
                    'participant': 'å‚ä¸è€…', 
                    'observer': 'è§‚å¯Ÿè€…'
                };
                return roleMap[type] || type;
            }
            
            const roleMap = {
                'master': 'Master Controller',
                'participant': 'Participant',
                'observer': 'Observer'
            };
            return roleMap[type] || type;
        }

        // ç¿»è¯‘ç”¨æˆ·è§’è‰²çš„å‡½æ•°
        function getTranslatedUserRole(userRole) {
            if (!window.i18nManager || window.i18nManager.getCurrentLanguage() === 'zh') {
                const userRoleMap = {
                    'ç®¡ç†å‘˜': 'ç®¡ç†å‘˜',
                    'åè°ƒå‘˜': 'åè°ƒå‘˜',
                    'è§‚å¯Ÿè€…': 'è§‚å¯Ÿè€…'
                };
                return userRoleMap[userRole] || userRole;
            }
            
            const userRoleMap = {
                'ç®¡ç†å‘˜': 'Administrator',
                'åè°ƒå‘˜': 'Coordinator',
                'è§‚å¯Ÿè€…': 'Observer'
            };
            return userRoleMap[userRole] || userRole;
        }

        // ç¿»è¯‘çŠ¶æ€çš„å‡½æ•°
        function getTranslatedStatus(status) {
            if (!window.i18nManager || window.i18nManager.getCurrentLanguage() === 'zh') {
                const statusMap = {
                    'online': 'åœ¨çº¿',
                    'offline': 'ç¦»çº¿',
                    'training': 'è®­ç»ƒä¸­',
                    'completed': 'å·²å®Œæˆ',
                    'idle': 'ç©ºé—²',
                    'error': 'é”™è¯¯',
                    'active': 'åœ¨çº¿'
                };
                return statusMap[status] || status;
            }
            
            const statusMap = {
                'online': 'Online',
                'offline': 'Offline', 
                'training': 'Training',
                'completed': 'Completed',
                'idle': 'Idle',
                'error': 'Error',
                'active': 'Online'
            };
            return statusMap[status] || status;
        }

        // ç¿»è¯‘å¿ƒè·³æ—¶é—´æ ¼å¼çš„å‡½æ•°
        function getTranslatedHeartbeat(heartbeat) {
            if (!window.i18nManager || window.i18nManager.getCurrentLanguage() === 'zh') {
                return heartbeat;
            }
            
            // è½¬æ¢ä¸­æ–‡æ—¶é—´æ ¼å¼ä¸ºè‹±æ–‡
            if (heartbeat.includes('ç§’å‰')) {
                const seconds = heartbeat.replace('ç§’å‰', '');
                return `${seconds}s ago`;
            } else if (heartbeat.includes('åˆ†é’Ÿå‰')) {
                const minutes = heartbeat.replace('åˆ†é’Ÿå‰', '');
                return `${minutes}m ago`;
            } else if (heartbeat.includes('å°æ—¶å‰')) {
                const hours = heartbeat.replace('å°æ—¶å‰', '');
                return `${hours}h ago`;
            }
            
            return heartbeat;
        }

        // ç›‘å¬è¯­è¨€åˆ‡æ¢äº‹ä»¶
        window.addEventListener('languageChanged', function(event) {
            // é‡æ–°æ¸²æŸ“ç½‘ç»œå¯è§†åŒ–å’Œè¡¨æ ¼ä»¥åº”ç”¨æ–°çš„ç¿»è¯‘
            renderNetworkVisualization();
            fillControlNodesTable();
            fillEdgeNodesTable();
        });

        // é¡µé¢åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // ç¡®ä¿ç”¨æˆ·ç™»å½•çŠ¶æ€ï¼ˆä¸ºå¯è§†åŒ–é¡µé¢æä¾›æ¨¡æ‹Ÿç™»å½•ï¼‰
            if (!localStorage.getItem('user') || !localStorage.getItem('user_token')) {
                // è®¾ç½®é»˜è®¤ç”¨æˆ·ä¿¡æ¯
                const defaultUser = {
                    name: 'P2PAIç”¨æˆ·',
                    userType: 'client',
                    id: 'p2pai_user_001'
                };
                localStorage.setItem('user', JSON.stringify(defaultUser));
                localStorage.setItem('user_token', 'mock-token-' + Date.now());
                localStorage.setItem('auth_token', 'p2pai-auth-token');
            }
            
            // ä»localStorageè·å–é¡¹ç›®ID
            const storedProjectId = localStorage.getItem('currentProjectId');
            if (storedProjectId) {
                projectId = storedProjectId;
            }
            
            // åˆå§‹åŒ–é¡¹ç›®ä¿¡æ¯
            initializeProjectInfo();
            
            // æ£€æŸ¥SVGå®¹å™¨æ˜¯å¦å­˜åœ¨å¹¶åˆå§‹åŒ–å¯è§†åŒ–
            const svgContainer = document.getElementById('networkSvg');
            if (svgContainer) {
                initializeVisualization();
            }
        });
    </script>
</body>
</html>